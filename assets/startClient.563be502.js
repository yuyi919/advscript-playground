import{c as e}from"./parser.d5d33482.js";import{e as t,f as i,g as n,b as o,h as r,s,m as a,a as c}from"./lsp.289540be.js";import{M as l,a as d,b as u,P as g,D as h,S as p,_ as m,e as f,m as v}from"./index.ee2a88f2.js";import{v as C,T as y}from"./vsc.14d9df5d.js";class D extends l{constructor(){super(...arguments),this._isCompleting=!1}createRenameProvider(e,t){return t.resolveRenameLocation?{...super.createRenameProvider(e,t),resolveRenameLocation:async(i,n,o)=>{if(!this.matchModel(e,d.fromModel(i)))return;const r=i.getWordUntilPosition(n),s=await t.resolveRenameLocation({textDocument:this.m2p.asTextDocumentIdentifier(i),position:this.m2p.asPosition(n.lineNumber,r.startColumn)},o);return s?(console.log("resolveRenameLocation",s,this.p2m.asRange(s.range)),{range:this.p2m.asRange(s.range),text:s.text}):{rejectReason:"此元素无法重命名"}}}:super.createRenameProvider(e,t)}createCompletionProvider(e,t,...i){return super.createCompletionProvider(e,{...t,provideCompletionItems:async(e,i)=>{this._isCompleting=!0;try{console.log("provideCompletionItems",e.position,this._monaco.languages.CompletionTriggerKind[e.context.triggerKind],e.context.triggerCharacter);const n=await t.provideCompletionItems(e,i);if(n)return console.log("provideCompletionItems",n),n}catch(n){}finally{this._isCompleting=!1}}},...i)}registerInlineCompletionItemProvider(e,t){const i=this.createInlineCompletionProvider(e,t),n=new h;for(const o of this.matchLanguage(e))n.push(this._monaco.languages.registerInlineCompletionsProvider(o,i));return n}createInlineCompletionProvider(e,t){return{provideInlineCompletions:async(i,n,o,r)=>{if(o.selectedSuggestionInfo||!this.matchModel(e,d.fromModel(i)))return;await new Promise((e=>setTimeout(e,0)));const s=i.getWordUntilPosition(n),a=[];if(!this._isCompleting){if(""!==s.word.trim()){console.log("provideInlineCompletions",s,this._monaco.languages.InlineCompletionTriggerKind[o.triggerKind],o.selectedSuggestionInfo,n);const e=new this._monaco.Range(n.lineNumber,s.startColumn,n.lineNumber,s.endColumn),c=this.m2p.asCompletionParams(i,n,{triggerCharacter:s.word,triggerKind:this._monaco.languages.CompletionTriggerKind.Invoke}),l=await t.provideCompletionItems(c,r);if(!l)return;const{suggestions:d,incomplete:u}=this.p2m.asCompletionResult(l,e);console.log("provideInlineCompletions",{suggestions:d,incomplete:u}),o.selectedSuggestionInfo&&a.push(o.selectedSuggestionInfo),d.forEach((e=>{var t,i;a.push({text:e.insertText,range:this._monaco.Range.isIRange(e.range)?e.range:(null==(t=e.range)?void 0:t.insert)||(null==(i=e.range)?void 0:i.replace)})}))}return{items:a}}},freeInlineCompletions(e){}}}}var _={},S={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.DisposableCollection=e.Disposable=void 0;const i=t;Object.defineProperty(e,"Disposable",{enumerable:!0,get:function(){return i.Disposable}});e.DisposableCollection=class{constructor(){this.disposables=[]}dispose(){for(;0!==this.disposables.length;)this.disposables.pop().dispose()}push(e){const t=this.disposables;return t.push(e),{dispose(){const i=t.indexOf(e);-1!==i&&t.splice(i,1)}}}}}(S);var R={},w={};Object.defineProperty(w,"__esModule",{value:!0});var T={};Object.defineProperty(T,"__esModule",{value:!0}),T.WebSocketMessageReader=void 0;const x=i;class P extends x.AbstractMessageReader{constructor(e){super(),this.socket=e,this.state="initial",this.events=[],this.socket.onMessage((e=>this.readMessage(e))),this.socket.onError((e=>this.fireError(e))),this.socket.onClose(((e,t)=>{if(1e3!==e){const i={name:""+e,message:`Error during socket reconnect: code = ${e}, reason = ${t}`};this.fireError(i)}this.fireClose()}))}listen(e){if("initial"===this.state)for(this.state="listening",this.callback=e;0!==this.events.length;){const e=this.events.pop();e.message?this.readMessage(e.message):e.error?this.fireError(e.error):this.fireClose()}return{dispose:()=>{this.callback===e&&(this.callback=void 0)}}}readMessage(e){if("initial"===this.state)this.events.splice(0,0,{message:e});else if("listening"===this.state){const t=JSON.parse(e);this.callback(t)}}fireError(e){"initial"===this.state?this.events.splice(0,0,{error:e}):"listening"===this.state&&super.fireError(e)}fireClose(){"initial"===this.state?this.events.splice(0,0,{}):"listening"===this.state&&super.fireClose(),this.state="closed"}}T.WebSocketMessageReader=P;var b={},k=e&&e.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{c(n.next(e))}catch(t){r(t)}}function a(e){try{c(n.throw(e))}catch(t){r(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(b,"__esModule",{value:!0}),b.WebSocketMessageWriter=void 0;const O=n;class F extends O.AbstractMessageWriter{constructor(e){super(),this.socket=e,this.errorCount=0}end(){}write(e){return k(this,void 0,void 0,(function*(){try{const t=JSON.stringify(e);this.socket.send(t)}catch(t){this.errorCount++,this.fireError(t,e,this.errorCount)}}))}}b.WebSocketMessageWriter=F;var E={};Object.defineProperty(E,"__esModule",{value:!0}),E.createWebSocketConnection=void 0;const I=o,M=T,q=b;var L,H,K;E.createWebSocketConnection=function(e,t){const i=new M.WebSocketMessageReader(e),n=new q.WebSocketMessageWriter(e),o=I.createMessageConnection(i,n,t);return o.onClose((()=>o.dispose())),o},L=R,H=e&&e.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),K=e&&e.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||H(t,e,i)},Object.defineProperty(L,"__esModule",{value:!0}),K(w,L),K(T,L),K(b,L),K(E,L);var A={};Object.defineProperty(A,"__esModule",{value:!0}),A.ConsoleLogger=void 0;A.ConsoleLogger=class{error(e){console.error(e)}warn(e){console.warn(e)}info(e){console.info(e)}log(e){console.log(e)}debug(e){console.debug(e)}};var N={};Object.defineProperty(N,"__esModule",{value:!0}),N.toSocket=N.listen=void 0;const W=R,U=A;function z(e){return{send:t=>e.send(t),onMessage:t=>e.onmessage=e=>t(e.data),onError:t=>e.onerror=e=>{"message"in e&&t(e.message)},onClose:t=>e.onclose=e=>t(e.code,e.reason),dispose:()=>e.close()}}N.listen=function(e){const{webSocket:t,onConnection:i}=e,n=e.logger||new U.ConsoleLogger;t.onopen=()=>{const e=z(t),o=W.createWebSocketConnection(e,n);i(o)}},N.toSocket=z,function(t){var i=e&&e.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),n=e&&e.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),n(o,t),n(r,t),n(S,t),n(R,t),n(A,t),n(N,t)}(_);var j=function(e){return e&&2===e.CLOSING},$=function(e,t,i){Object.defineProperty(t,i,{get:function(){return e[i]},set:function(t){e[i]=t},enumerable:!0,configurable:!0})},B=function(e){return e.minReconnectionDelay+Math.random()*e.minReconnectionDelay},V=["onopen","onclose","onmessage","onerror"],G=function(e,t,i){var n,o,r=this;void 0===i&&(i={});var s=0,a=0,c=!0,l=null,d={};if(!(this instanceof G))throw new TypeError("Failed to construct 'ReconnectingWebSocket': Please use the 'new' operator");var u={constructor:"undefined"!=typeof WebSocket&&j(WebSocket)?WebSocket:null,maxReconnectionDelay:1e4,minReconnectionDelay:1500,reconnectionDelayGrowFactor:1.3,connectionTimeout:4e3,maxRetries:1/0,debug:!1};if(Object.keys(u).filter((function(e){return i.hasOwnProperty(e)})).forEach((function(e){return u[e]=i[e]})),!j(u.constructor))throw new TypeError("Invalid WebSocket constructor. Set `options.constructor`");var g=u.debug?function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return console.log.apply(console,["RWS:"].concat(e))}:function(){},h=function(e,t){return setTimeout((function(){var i=new Error(t);i.code=e,Array.isArray(d.error)&&d.error.forEach((function(e){return(0,e[0])(i)})),n.onerror&&n.onerror(i)}),0)},p=function(){g("handleClose",{shouldRetry:c}),a++,g("retries count:",a),a>u.maxRetries?h("EHOSTDOWN","Too many failed connection attempts"):(s=s?function(e,t){var i=t*e.reconnectionDelayGrowFactor;return i>e.maxReconnectionDelay?e.maxReconnectionDelay:i}(u,s):B(u),g("handleClose - reconnectDelay:",s),c&&setTimeout(m,s))},m=function(){if(c){g("connect");var i=n,m="function"==typeof e?e():e;for(var f in n=new u.constructor(m,t),o=setTimeout((function(){g("timeout"),n.close(),h("ETIMEDOUT","Connection timeout")}),u.connectionTimeout),g("bypass properties"),n)["addEventListener","removeEventListener","close","send"].indexOf(f)<0&&$(n,r,f);n.addEventListener("open",(function(){clearTimeout(o),g("open"),s=B(u),g("reconnectDelay:",s),a=0})),n.addEventListener("close",p),function(e,t,i){Object.keys(i).forEach((function(t){i[t].forEach((function(i){var n=i[0],o=i[1];e.addEventListener(t,n,o)}))})),t&&V.forEach((function(i){e[i]=t[i]}))}(n,i,d),n.onclose=n.onclose||l,l=null}};g("init"),m(),this.close=function(e,t,i){void 0===e&&(e=1e3),void 0===t&&(t="");var o=void 0===i?{}:i,r=o.keepClosed,h=void 0!==r&&r,m=o.fastClose,f=void 0===m||m,v=o.delay,C=void 0===v?0:v;if(g("close - params:",{reason:t,keepClosed:h,fastClose:f,delay:C,retriesCount:a,maxRetries:u.maxRetries}),c=!h&&a<=u.maxRetries,C&&(s=C),n.close(e,t),f){var y={code:e,reason:t,wasClean:!0};p(),n.removeEventListener("close",p),Array.isArray(d.close)&&d.close.forEach((function(e){var t=e[0],i=e[1];t(y),n.removeEventListener("close",t,i)})),n.onclose&&(l=n.onclose,n.onclose(y),n.onclose=null)}},this.send=function(e){n.send(e)},this.addEventListener=function(e,t,i){Array.isArray(d[e])?d[e].some((function(e){return e[0]===t}))||d[e].push([t,i]):d[e]=[[t,i]],n.addEventListener(e,t,i)},this.removeEventListener=function(e,t,i){Array.isArray(d[e])&&(d[e]=d[e].filter((function(e){return e[0]!==t}))),n.removeEventListener(e,t,i)}},J=G;var Q={},Z={};Object.defineProperty(Z,"__esModule",{value:!0}),Z.toJSONObject=ee=Z.ConfigurationFeature=void 0;const X=C,Y=a;var ee=Z.ConfigurationFeature=class{constructor(e){this._client=e}fillClientCapabilities(e){e.workspace=e.workspace||{},e.workspace.configuration=!0}initialize(){let e=this._client;e.onRequest(Y.ConfigurationRequest.type,((t,i)=>{let n=e=>{let t=[];for(let i of e.items){let e=void 0!==i.scopeUri&&null!==i.scopeUri?this._client.protocol2CodeConverter.asUri(i.scopeUri):void 0;t.push(this.getConfiguration(e,null!==i.section?i.section:void 0))}return t},o=e.clientOptions.middleware.workspace;return o&&o.configuration?o.configuration(t,i,n):n(t)}))}getConfiguration(e,t){let i=null;if(t){let n=t.lastIndexOf(".");if(-1===n)i=te(X.workspace.getConfiguration(void 0,e).get(t));else{let o=X.workspace.getConfiguration(t.substr(0,n),e);o&&(i=te(o.get(t.substr(n+1))))}}else{let t=X.workspace.getConfiguration(void 0,e);i={};for(let e of Object.keys(t))t.has(e)&&(i[e]=te(t.get(e)))}return void 0===i&&(i=null),i}dispose(){}};function te(e){if(e){if(Array.isArray(e))return e.map(te);if("object"==typeof e){const t=Object.create(null);for(const i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=te(e[i]));return t}}return e}Z.toJSONObject=te;var ie={},ne={};function oe(e){return"string"==typeof e||e instanceof String}function re(e){return"function"==typeof e}function se(e){return Array.isArray(e)}function ae(e){return e&&re(e.then)}Object.defineProperty(ne,"__esModule",{value:!0}),ne.asPromise=ne.thenable=ne.typedArray=ne.stringArray=ne.array=ne.func=ne.error=ne.number=ne.string=ne.boolean=void 0,ne.boolean=function(e){return!0===e||!1===e},ne.string=oe,ne.number=function(e){return"number"==typeof e||e instanceof Number},ne.error=function(e){return e instanceof Error},ne.func=re,ne.array=se,ne.stringArray=function(e){return se(e)&&e.every((e=>oe(e)))},ne.typedArray=function(e,t){return Array.isArray(e)&&e.every(t)},ne.thenable=ae,ne.asPromise=function(e){return e instanceof Promise?e:ae(e)?new Promise(((t,i)=>{e.then((e=>t(e)),(e=>i(e)))})):Promise.resolve(e)};var ce={};Object.defineProperty(ce,"__esModule",{value:!0});const le=C;class de extends le.CompletionItem{constructor(e){super(e)}}ce.default=de;var ue={};Object.defineProperty(ue,"__esModule",{value:!0});const ge=C;class he extends ge.CodeLens{constructor(e){super(e)}}ue.default=he;var pe={};Object.defineProperty(pe,"__esModule",{value:!0});const me=C;class fe extends me.DocumentLink{constructor(e,t){super(e,t)}}pe.default=fe;var ve={};Object.defineProperty(ve,"__esModule",{value:!0});const Ce=C;class ye extends Ce.CodeAction{constructor(e,t){super(e),this.data=t}}ve.default=ye;var De={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ProtocolDiagnostic=e.DiagnosticCode=void 0;const t=C,i=ne;(e.DiagnosticCode||(e.DiagnosticCode={})).is=function(e){const t=e;return null!=t&&(i.number(t.value)||i.string(t.value))&&i.string(t.target)};class n extends t.Diagnostic{constructor(e,t,i,n){super(e,t,i),this.data=n,this.hasDiagnosticCode=!1}}e.ProtocolDiagnostic=n}(De);var _e={};Object.defineProperty(_e,"__esModule",{value:!0});const Se=C;class Re extends Se.CallHierarchyItem{constructor(e,t,i,n,o,r,s){super(e,t,i,n,o,r),void 0!==s&&(this.data=s)}}_e.default=Re,Object.defineProperty(ie,"__esModule",{value:!0}),ie.createConverter=void 0;const we=C,Te=a,xe=ne,Pe=ce,be=ue,ke=pe,Oe=ve,Fe=De,Ee=_e,Ie=a;var Me;(Me||(Me={})).is=function(e){const t=e;return t&&!!t.inserting&&!!t.replacing},ie.createConverter=function(e){const t=e||(e=>e.toString());function i(e){return t(e)}function n(e){return{uri:t(e.uri)}}function o(e){switch(e){case we.TextDocumentSaveReason.Manual:return Te.TextDocumentSaveReason.Manual;case we.TextDocumentSaveReason.AfterDelay:return Te.TextDocumentSaveReason.AfterDelay;case we.TextDocumentSaveReason.FocusOut:return Te.TextDocumentSaveReason.FocusOut}return Te.TextDocumentSaveReason.Manual}function r(e){switch(e){case we.CompletionTriggerKind.TriggerCharacter:return Te.CompletionTriggerKind.TriggerCharacter;case we.CompletionTriggerKind.TriggerForIncompleteCompletions:return Te.CompletionTriggerKind.TriggerForIncompleteCompletions;default:return Te.CompletionTriggerKind.Invoked}}function s(e){switch(e){case we.SignatureHelpTriggerKind.Invoke:return Te.SignatureHelpTriggerKind.Invoked;case we.SignatureHelpTriggerKind.TriggerCharacter:return Te.SignatureHelpTriggerKind.TriggerCharacter;case we.SignatureHelpTriggerKind.ContentChange:return Te.SignatureHelpTriggerKind.ContentChange}}function a(e){return{label:e.label}}function c(e){return{label:e.label,parameters:(t=e.parameters,t.map(a))};var t}function l(e){return{line:e.line,character:e.character}}function d(e){return null==e?e:{line:e.line,character:e.character}}function u(e){return null==e?e:{start:d(e.start),end:d(e.end)}}function g(e){return null==e?e:Te.Location.create(i(e.uri),u(e.range))}function h(e){switch(e){case we.DiagnosticSeverity.Error:return Te.DiagnosticSeverity.Error;case we.DiagnosticSeverity.Warning:return Te.DiagnosticSeverity.Warning;case we.DiagnosticSeverity.Information:return Te.DiagnosticSeverity.Information;case we.DiagnosticSeverity.Hint:return Te.DiagnosticSeverity.Hint}}function p(e){switch(e){case we.DiagnosticTag.Unnecessary:return Te.DiagnosticTag.Unnecessary;case we.DiagnosticTag.Deprecated:return Te.DiagnosticTag.Deprecated;default:return}}function m(e){return{message:e.message,location:g(e.location)}}function f(e){const t=Te.Diagnostic.create(u(e.range),e.message),n=e instanceof Fe.ProtocolDiagnostic?e:void 0;void 0!==n&&void 0!==n.data&&(t.data=n.data);const o=function(e){if(null!=e)return xe.number(e)||xe.string(e)?e:{value:e.value,target:i(e.target)}}(e.code);return Fe.DiagnosticCode.is(o)?void 0!==n&&n.hasDiagnosticCode?t.code=o:(t.code=o.value,t.codeDescription={href:o.target}):t.code=o,xe.number(e.severity)&&(t.severity=h(e.severity)),Array.isArray(e.tags)&&(t.tags=function(e){if(!e)return;let t=[];for(let i of e){let e=p(i);void 0!==e&&t.push(e)}return t.length>0?t:void 0}(e.tags)),e.relatedInformation&&(t.relatedInformation=e.relatedInformation.map(m)),e.source&&(t.source=e.source),t}function v(e){return null==e?e:e.map(f)}function C(e){switch(e){case we.CompletionItemTag.Deprecated:return Te.CompletionItemTag.Deprecated}}function y(e){return{range:u(e.range),newText:e.newText}}function D(e){return e<=we.SymbolKind.TypeParameter?e+1:Te.SymbolKind.Property}function _(e){return e}function S(e){return e.map(_)}function R(e){let t=Te.Command.create(e.title,e.command);return e.arguments&&(t.arguments=e.arguments),t}return{asUri:i,asTextDocumentIdentifier:n,asVersionedTextDocumentIdentifier:function(e){return{uri:t(e.uri),version:e.version}},asOpenTextDocumentParams:function(e){return{textDocument:{uri:t(e.uri),languageId:e.languageId,version:e.version,text:e.getText()}}},asChangeTextDocumentParams:function(e){if(function(e){let t=e;return!!t.uri&&!!t.version}(e)){return{textDocument:{uri:t(e.uri),version:e.version},contentChanges:[{text:e.getText()}]}}if(function(e){let t=e;return!!t.document&&!!t.contentChanges}(e)){let i=e.document;return{textDocument:{uri:t(i.uri),version:i.version},contentChanges:e.contentChanges.map((e=>{let t=e.range;return{range:{start:{line:t.start.line,character:t.start.character},end:{line:t.end.line,character:t.end.character}},rangeLength:e.rangeLength,text:e.text}}))}}throw Error("Unsupported text document change parameter")},asCloseTextDocumentParams:function(e){return{textDocument:n(e)}},asSaveTextDocumentParams:function(e,t=!1){let i={textDocument:n(e)};return t&&(i.text=e.getText()),i},asWillSaveTextDocumentParams:function(e){return{textDocument:n(e.document),reason:o(e.reason)}},asDidCreateFilesParams:function(e){return{files:e.files.map((e=>({uri:t(e)})))}},asDidRenameFilesParams:function(e){return{files:e.files.map((e=>({oldUri:t(e.oldUri),newUri:t(e.newUri)})))}},asDidDeleteFilesParams:function(e){return{files:e.files.map((e=>({uri:t(e)})))}},asWillCreateFilesParams:function(e){return{files:e.files.map((e=>({uri:t(e)})))}},asWillRenameFilesParams:function(e){return{files:e.files.map((e=>({oldUri:t(e.oldUri),newUri:t(e.newUri)})))}},asWillDeleteFilesParams:function(e){return{files:e.files.map((e=>({uri:t(e)})))}},asTextDocumentPositionParams:function(e,t){return{textDocument:n(e),position:l(t)}},asCompletionParams:function(e,t,i){return{textDocument:n(e),position:l(t),context:{triggerKind:r(i.triggerKind),triggerCharacter:i.triggerCharacter}}},asSignatureHelpParams:function(e,t,i){return{textDocument:n(e),position:l(t),context:{isRetrigger:i.isRetrigger,triggerCharacter:i.triggerCharacter,triggerKind:s(i.triggerKind),activeSignatureHelp:(o=i.activeSignatureHelp,void 0===o?o:{signatures:(r=o.signatures,r.map(c)),activeSignature:o.activeSignature,activeParameter:o.activeParameter})}};var o,r},asWorkerPosition:l,asRange:u,asPosition:d,asPositions:function(e){let t=[];for(let i of e)t.push(d(i));return t},asLocation:g,asDiagnosticSeverity:h,asDiagnosticTag:p,asDiagnostic:f,asDiagnostics:v,asCompletionItem:function(e){let t={label:e.label},i=e instanceof Pe.default?e:void 0;var n,o;e.detail&&(t.detail=e.detail),e.documentation&&(i&&"$string"!==i.documentationFormat?t.documentation=function(e,t){switch(e){case"$string":return t;case Te.MarkupKind.PlainText:return{kind:e,value:t};case Te.MarkupKind.Markdown:return{kind:e,value:t.value};default:return`Unsupported Markup content received. Kind is: ${e}`}}(i.documentationFormat,e.documentation):t.documentation=e.documentation),e.filterText&&(t.filterText=e.filterText),function(e,t){let i,n,o=Te.InsertTextFormat.PlainText;t.textEdit?(i=t.textEdit.newText,n=t.textEdit.range):t.insertText instanceof we.SnippetString?(o=Te.InsertTextFormat.Snippet,i=t.insertText.value):i=t.insertText;t.range&&(n=t.range);e.insertTextFormat=o,t.fromEdit&&void 0!==i&&void 0!==n?e.textEdit=function(e,t){return Me.is(t)?Te.InsertReplaceEdit.create(e,u(t.inserting),u(t.replacing)):{newText:e,range:u(t)}}(i,n):e.insertText=i}(t,e),xe.number(e.kind)&&(t.kind=(n=e.kind,void 0!==(o=i&&i.originalItemKind)?o:n+1)),e.sortText&&(t.sortText=e.sortText),e.additionalTextEdits&&(t.additionalTextEdits=function(e){if(null==e)return e;return e.map(y)}(e.additionalTextEdits)),e.commitCharacters&&(t.commitCharacters=e.commitCharacters.slice()),e.command&&(t.command=R(e.command)),!0!==e.preselect&&!1!==e.preselect||(t.preselect=e.preselect);const r=function(e){if(void 0===e)return e;const t=[];for(let i of e){const e=C(i);void 0!==e&&t.push(e)}return t}(e.tags);if(i){if(void 0!==i.data&&(t.data=i.data),!0===i.deprecated||!1===i.deprecated){if(!0===i.deprecated&&void 0!==r&&r.length>0){const e=r.indexOf(we.CompletionItemTag.Deprecated);-1!==e&&r.splice(e,1)}t.deprecated=i.deprecated}void 0!==i.insertTextMode&&(t.insertTextMode=i.insertTextMode)}return void 0!==r&&r.length>0&&(t.tags=r),void 0===t.insertTextMode&&!0===e.keepWhitespace&&(t.insertTextMode=Ie.InsertTextMode.adjustIndentation),t},asTextEdit:y,asSymbolKind:D,asSymbolTag:_,asSymbolTags:S,asReferenceParams:function(e,t,i){return{textDocument:n(e),position:l(t),context:{includeDeclaration:i.includeDeclaration}}},asCodeAction:function(e){let t=Te.CodeAction.create(e.title);if(e instanceof Oe.default&&void 0!==e.data&&(t.data=e.data),void 0!==e.kind&&(t.kind=function(e){if(null==e)return;return e.value}(e.kind)),void 0!==e.diagnostics&&(t.diagnostics=v(e.diagnostics)),void 0!==e.edit)throw new Error("VS Code code actions can only be converted to a protocol code action without an edit.");return void 0!==e.command&&(t.command=R(e.command)),void 0!==e.isPreferred&&(t.isPreferred=e.isPreferred),void 0!==e.disabled&&(t.disabled={reason:e.disabled.reason}),t},asCodeActionContext:function(e){if(null==e)return e;let t;return e.only&&xe.string(e.only.value)&&(t=[e.only.value]),Te.CodeActionContext.create(v(e.diagnostics),t)},asCommand:R,asCodeLens:function(e){let t=Te.CodeLens.create(u(e.range));return e.command&&(t.command=R(e.command)),e instanceof be.default&&e.data&&(t.data=e.data),t},asFormattingOptions:function(e,t){const i={tabSize:e.tabSize,insertSpaces:e.insertSpaces};return t.trimTrailingWhitespace&&(i.trimTrailingWhitespace=!0),t.trimFinalNewlines&&(i.trimFinalNewlines=!0),t.insertFinalNewline&&(i.insertFinalNewline=!0),i},asDocumentSymbolParams:function(e){return{textDocument:n(e)}},asCodeLensParams:function(e){return{textDocument:n(e)}},asDocumentLink:function(e){let t=Te.DocumentLink.create(u(e.range));e.target&&(t.target=i(e.target)),void 0!==e.tooltip&&(t.tooltip=e.tooltip);let n=e instanceof ke.default?e:void 0;return n&&n.data&&(t.data=n.data),t},asDocumentLinkParams:function(e){return{textDocument:n(e)}},asCallHierarchyItem:function(e){const t={name:e.name,kind:D(e.kind),uri:i(e.uri),range:u(e.range),selectionRange:u(e.selectionRange)};return void 0!==e.detail&&e.detail.length>0&&(t.detail=e.detail),void 0!==e.tags&&(t.tags=S(e.tags)),e instanceof Ee.default&&void 0!==e.data&&(t.data=e.data),t}}};var qe={};Object.defineProperty(qe,"__esModule",{value:!0}),qe.createConverter=void 0;const Le=C,He=a,Ke=ne,Ae=ce,Ne=ue,We=pe,Ue=ve,ze=De,je=_e,$e=a;var Be;(Be||(Be={})).is=function(e){let t=e;return t&&Ke.string(t.language)&&Ke.string(t.value)},qe.createConverter=function(e,t){const i=e||(e=>Le.Uri.parse(e));function n(e){return i(e)}function o(e){return e.map(r)}function r(e){let t=new ze.ProtocolDiagnostic(l(e.range),e.message,u(e.severity),e.data);return void 0!==e.code&&(He.CodeDescription.is(e.codeDescription)?t.code={value:e.code,target:n(e.codeDescription.href)}:ze.DiagnosticCode.is(e.code)?(t.hasDiagnosticCode=!0,t.code={value:e.code.value,target:n(e.code.target)}):t.code=e.code),e.source&&(t.source=e.source),e.relatedInformation&&(t.relatedInformation=e.relatedInformation.map(s)),Array.isArray(e.tags)&&(t.tags=function(e){if(!e)return;let t=[];for(let i of e){let e=a(i);void 0!==e&&t.push(e)}return t.length>0?t:void 0}(e.tags)),t}function s(e){return new Le.DiagnosticRelatedInformation(R(e.location),e.message)}function a(e){switch(e){case He.DiagnosticTag.Unnecessary:return Le.DiagnosticTag.Unnecessary;case He.DiagnosticTag.Deprecated:return Le.DiagnosticTag.Deprecated;default:return}}function c(e){if(e)return new Le.Position(e.line,e.character)}function l(e){if(e)return new Le.Range(c(e.start),c(e.end))}function d(e){return e.map((e=>l(e)))}function u(e){if(null==e)return Le.DiagnosticSeverity.Error;switch(e){case He.DiagnosticSeverity.Error:return Le.DiagnosticSeverity.Error;case He.DiagnosticSeverity.Warning:return Le.DiagnosticSeverity.Warning;case He.DiagnosticSeverity.Information:return Le.DiagnosticSeverity.Information;case He.DiagnosticSeverity.Hint:return Le.DiagnosticSeverity.Hint}return Le.DiagnosticSeverity.Error}function g(e){if(Ke.string(e))return e;switch(e.kind){case He.MarkupKind.Markdown:return h(e.value);case He.MarkupKind.PlainText:return e.value;default:return`Unsupported Markup content received. Kind is: ${e.kind}`}}function h(e){const i=new Le.MarkdownString(e);return!0===t&&(i.isTrusted=t),i}function p(e){switch(e){case He.CompletionItemTag.Deprecated:return Le.CompletionItemTag.Deprecated}}function m(e){let t=function(e){if(null==e)return[];const t=[];for(let i of e){const e=p(i);void 0!==e&&t.push(e)}return t}(e.tags),i=new Ae.default(e.label);e.detail&&(i.detail=e.detail),e.documentation&&(i.documentation=g(e.documentation),i.documentationFormat=Ke.string(e.documentation)?"$string":e.documentation.kind),e.filterText&&(i.filterText=e.filterText);let n=function(e){return e.textEdit?e.insertTextFormat===He.InsertTextFormat.Snippet?{text:new Le.SnippetString(e.textEdit.newText),range:f(e.textEdit),fromEdit:!0}:{text:e.textEdit.newText,range:f(e.textEdit),fromEdit:!0}:e.insertText?e.insertTextFormat===He.InsertTextFormat.Snippet?{text:new Le.SnippetString(e.insertText),fromEdit:!1}:{text:e.insertText,fromEdit:!1}:void 0}(e);if(n&&(i.insertText=n.text,i.range=n.range,i.fromEdit=n.fromEdit),Ke.number(e.kind)){let[t,n]=(o=e.kind,He.CompletionItemKind.Text<=o&&o<=He.CompletionItemKind.TypeParameter?[o-1,void 0]:[Le.CompletionItemKind.Text,o]);i.kind=t,n&&(i.originalItemKind=n)}var o;return e.sortText&&(i.sortText=e.sortText),e.additionalTextEdits&&(i.additionalTextEdits=C(e.additionalTextEdits)),Ke.stringArray(e.commitCharacters)&&(i.commitCharacters=e.commitCharacters.slice()),e.command&&(i.command=M(e.command)),!0!==e.deprecated&&!1!==e.deprecated||(i.deprecated=e.deprecated,!0===e.deprecated&&t.push(Le.CompletionItemTag.Deprecated)),!0!==e.preselect&&!1!==e.preselect||(i.preselect=e.preselect),void 0!==e.data&&(i.data=e.data),t.length>0&&(i.tags=t),void 0!==e.insertTextMode&&(i.insertTextMode=e.insertTextMode,e.insertTextMode===$e.InsertTextMode.asIs&&(i.keepWhitespace=!0)),i}function f(e){return He.InsertReplaceEdit.is(e)?{inserting:l(e.insert),replacing:l(e.replace)}:l(e.range)}function v(e){if(e)return new Le.TextEdit(l(e.range),e.newText)}function C(e){if(e)return e.map(v)}function y(e){return e.map(D)}function D(e){let t=new Le.SignatureInformation(e.label);return void 0!==e.documentation&&(t.documentation=g(e.documentation)),void 0!==e.parameters&&(t.parameters=_(e.parameters)),void 0!==e.activeParameter&&(t.activeParameter=e.activeParameter),t}function _(e){return e.map(S)}function S(e){let t=new Le.ParameterInformation(e.label);return e.documentation&&(t.documentation=g(e.documentation)),t}function R(e){if(e)return new Le.Location(i(e.uri),l(e.range))}function w(e){if(!e)return;let t={targetUri:i(e.targetUri),targetRange:l(e.targetRange),originSelectionRange:l(e.originSelectionRange),targetSelectionRange:l(e.targetSelectionRange)};if(!t.targetSelectionRange)throw new Error("targetSelectionRange must not be undefined or null");return t}function T(e){if(e){if(Ke.array(e)){if(0===e.length)return[];if(He.LocationLink.is(e[0])){return e.map((e=>w(e)))}return e.map((e=>R(e)))}return He.LocationLink.is(e)?[w(e)]:R(e)}}function x(e){let t=new Le.DocumentHighlight(l(e.range));return Ke.number(e.kind)&&(t.kind=P(e.kind)),t}function P(e){switch(e){case He.DocumentHighlightKind.Text:return Le.DocumentHighlightKind.Text;case He.DocumentHighlightKind.Read:return Le.DocumentHighlightKind.Read;case He.DocumentHighlightKind.Write:return Le.DocumentHighlightKind.Write}return Le.DocumentHighlightKind.Text}function b(e){return e<=He.SymbolKind.TypeParameter?e-1:Le.SymbolKind.Property}function k(e){switch(e){case He.SymbolTag.Deprecated:return Le.SymbolTag.Deprecated;default:return}}function O(e){if(null==e)return;const t=[];for(const i of e){const e=k(i);void 0!==e&&t.push(e)}return 0===t.length?void 0:t}function F(e,t){let n=new Le.SymbolInformation(e.name,b(e.kind),l(e.location.range),e.location.uri?i(e.location.uri):t);return I(n,e),e.containerName&&(n.containerName=e.containerName),n}function E(e){let t=new Le.DocumentSymbol(e.name,e.detail||"",b(e.kind),l(e.range),l(e.selectionRange));if(I(t,e),void 0!==e.children&&e.children.length>0){let i=[];for(let t of e.children)i.push(E(t));t.children=i}return t}function I(e,t){e.tags=O(t.tags),t.deprecated&&(e.tags?e.tags.includes(Le.SymbolTag.Deprecated)||(e.tags=e.tags.concat(Le.SymbolTag.Deprecated)):e.tags=[Le.SymbolTag.Deprecated])}function M(e){let t={title:e.title,command:e.command};return e.arguments&&(t.arguments=e.arguments),t}const q=new Map;function L(e){if(null==e)return;let t=q.get(e);if(t)return t;let i=e.split(".");t=Le.CodeActionKind.Empty;for(let n of i)t=t.append(n);return t}function H(e){if(!e)return;let t=new Ne.default(l(e.range));return e.command&&(t.command=M(e.command)),void 0!==e.data&&null!==e.data&&(t.data=e.data),t}function K(e){if(!e)return;const t=new Map;if(void 0!==e.changeAnnotations)for(const i of Object.keys(e.changeAnnotations)){const n=A(e.changeAnnotations[i]);t.set(i,n)}const n=e=>void 0===e?void 0:t.get(e),o=new Le.WorkspaceEdit;if(e.documentChanges)for(const r of e.documentChanges)if(He.CreateFile.is(r))o.createFile(i(r.uri),r.options,n(r.annotationId));else if(He.RenameFile.is(r))o.renameFile(i(r.oldUri),i(r.newUri),r.options,n(r.annotationId));else if(He.DeleteFile.is(r))o.deleteFile(i(r.uri),r.options,n(r.annotationId));else{if(!He.TextDocumentEdit.is(r))throw new Error(`Unknown workspace edit change received:\n${JSON.stringify(r,void 0,4)}`);{const e=i(r.textDocument.uri);for(const t of r.edits)$e.AnnotatedTextEdit.is(t)?o.replace(e,l(t.range),t.newText,n(t.annotationId)):o.replace(e,l(t.range),t.newText)}}else e.changes&&Object.keys(e.changes).forEach((t=>{o.set(i(t),C(e.changes[t]))}));return o}function A(e){if(void 0!==e)return{label:e.label,needsConfirmation:!!e.needsConfirmation,description:e.description}}function N(e){let t=l(e.range),i=e.target?n(e.target):void 0,o=new We.default(t,i);return void 0!==e.tooltip&&(o.tooltip=e.tooltip),void 0!==e.data&&null!==e.data&&(o.data=e.data),o}function W(e){return new Le.Color(e.red,e.green,e.blue,e.alpha)}function U(e){return new Le.ColorInformation(l(e.range),W(e.color))}function z(e){let t=new Le.ColorPresentation(e.label);return t.additionalTextEdits=C(e.additionalTextEdits),e.textEdit&&(t.textEdit=v(e.textEdit)),t}function j(e){if(e)switch(e){case He.FoldingRangeKind.Comment:return Le.FoldingRangeKind.Comment;case He.FoldingRangeKind.Imports:return Le.FoldingRangeKind.Imports;case He.FoldingRangeKind.Region:return Le.FoldingRangeKind.Region}}function $(e){return new Le.FoldingRange(e.startLine,e.endLine,j(e.kind))}function B(e){return new Le.SelectionRange(l(e.range),e.parent?B(e.parent):void 0)}function V(e){if(null===e)return;let t=new je.default(b(e.kind),e.name,e.detail||"",n(e.uri),l(e.range),l(e.selectionRange),e.data);return void 0!==e.tags&&(t.tags=O(e.tags)),t}function G(e){return new Le.CallHierarchyIncomingCall(V(e.from),d(e.fromRanges))}function J(e){return new Le.CallHierarchyOutgoingCall(V(e.to),d(e.fromRanges))}function Q(e){return new Le.SemanticTokensEdit(e.start,e.deleteCount,void 0!==e.data?new Uint32Array(e.data):void 0)}return q.set(He.CodeActionKind.Empty,Le.CodeActionKind.Empty),q.set(He.CodeActionKind.QuickFix,Le.CodeActionKind.QuickFix),q.set(He.CodeActionKind.Refactor,Le.CodeActionKind.Refactor),q.set(He.CodeActionKind.RefactorExtract,Le.CodeActionKind.RefactorExtract),q.set(He.CodeActionKind.RefactorInline,Le.CodeActionKind.RefactorInline),q.set(He.CodeActionKind.RefactorRewrite,Le.CodeActionKind.RefactorRewrite),q.set(He.CodeActionKind.Source,Le.CodeActionKind.Source),q.set(He.CodeActionKind.SourceOrganizeImports,Le.CodeActionKind.SourceOrganizeImports),{asUri:n,asDiagnostics:o,asDiagnostic:r,asRange:l,asRanges:d,asPosition:c,asDiagnosticSeverity:u,asDiagnosticTag:a,asHover:function(e){if(e)return new Le.Hover(function(e){if(Ke.string(e))return h(e);if(Be.is(e))return h().appendCodeblock(e.value,e.language);if(Array.isArray(e)){let t=[];for(let i of e){let e=h();Be.is(i)?e.appendCodeblock(i.value,i.language):e.appendMarkdown(i),t.push(e)}return t}{let t;switch(e.kind){case He.MarkupKind.Markdown:return h(e.value);case He.MarkupKind.PlainText:return t=h(),t.appendText(e.value),t;default:return t=h(),t.appendText(`Unsupported Markup content received. Kind is: ${e.kind}`),t}}}(e.contents),l(e.range))},asCompletionResult:function(e){if(!e)return;if(Array.isArray(e)){return e.map(m)}let t=e;return new Le.CompletionList(t.items.map(m),t.isIncomplete)},asCompletionItem:m,asTextEdit:v,asTextEdits:C,asSignatureHelp:function(e){if(!e)return;let t=new Le.SignatureHelp;return Ke.number(e.activeSignature)?t.activeSignature=e.activeSignature:t.activeSignature=0,Ke.number(e.activeParameter)?t.activeParameter=e.activeParameter:t.activeParameter=0,e.signatures&&(t.signatures=y(e.signatures)),t},asSignatureInformations:y,asSignatureInformation:D,asParameterInformations:_,asParameterInformation:S,asDeclarationResult:function(e){if(e)return T(e)},asDefinitionResult:function(e){if(e)return T(e)},asLocation:R,asReferences:function(e){if(e)return e.map((e=>R(e)))},asDocumentHighlights:function(e){if(e)return e.map(x)},asDocumentHighlight:x,asDocumentHighlightKind:P,asSymbolKind:b,asSymbolTag:k,asSymbolTags:O,asSymbolInformations:function(e,t){if(e)return e.map((e=>F(e,t)))},asSymbolInformation:F,asDocumentSymbols:function(e){if(null!=e)return e.map(E)},asDocumentSymbol:E,asCommand:M,asCommands:function(e){if(e)return e.map(M)},asCodeAction:function(e){if(null==e)return;let t=new Ue.default(e.title,e.data);return void 0!==e.kind&&(t.kind=L(e.kind)),void 0!==e.diagnostics&&(t.diagnostics=o(e.diagnostics)),void 0!==e.edit&&(t.edit=K(e.edit)),void 0!==e.command&&(t.command=M(e.command)),void 0!==e.isPreferred&&(t.isPreferred=e.isPreferred),void 0!==e.disabled&&(t.disabled={reason:e.disabled.reason}),t},asCodeActionKind:L,asCodeActionKinds:function(e){if(null!=e)return e.map((e=>L(e)))},asCodeLens:H,asCodeLenses:function(e){if(e)return e.map((e=>H(e)))},asWorkspaceEdit:K,asDocumentLink:N,asDocumentLinks:function(e){if(e)return e.map(N)},asFoldingRangeKind:j,asFoldingRange:$,asFoldingRanges:function(e){if(Array.isArray(e))return e.map($)},asColor:W,asColorInformation:U,asColorInformations:function(e){if(Array.isArray(e))return e.map(U)},asColorPresentation:z,asColorPresentations:function(e){if(Array.isArray(e))return e.map(z)},asSelectionRange:B,asSelectionRanges:function(e){if(!Array.isArray(e))return[];let t=[];for(let i of e)t.push(B(i));return t},asSemanticTokensLegend:function(e){return e},asSemanticTokens:function(e){if(null!=e)return new Le.SemanticTokens(new Uint32Array(e.data),e.resultId)},asSemanticTokensEdit:Q,asSemanticTokensEdits:function(e){if(null!=e)return new Le.SemanticTokensEdits(e.edits.map(Q),e.resultId)},asCallHierarchyItem:V,asCallHierarchyItems:function(e){if(null!==e)return e.map((e=>V(e)))},asCallHierarchyIncomingCall:G,asCallHierarchyIncomingCalls:function(e){if(null!==e)return e.map((e=>G(e)))},asCallHierarchyOutgoingCall:J,asCallHierarchyOutgoingCalls:function(e){if(null!==e)return e.map((e=>J(e)))},asLinkedEditingRanges:function(e){if(null!=e)return new Le.LinkedEditingRanges(d(e.ranges),function(e){if(null==e)return;return new RegExp(e)}(e.wordPattern))}}};var Ve={};Object.defineProperty(Ve,"__esModule",{value:!0}),Ve.Delayer=void 0;const Ge=a;Ve.Delayer=class{constructor(e){this.defaultDelay=e,this.timeout=void 0,this.completionPromise=void 0,this.onSuccess=void 0,this.task=void 0}trigger(e,t=this.defaultDelay){return this.task=e,t>=0&&this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise((e=>{this.onSuccess=e})).then((()=>{this.completionPromise=void 0,this.onSuccess=void 0;var e=this.task();return this.task=void 0,e}))),(t>=0||void 0===this.timeout)&&(this.timeout=Ge.RAL().timer.setTimeout((()=>{this.timeout=void 0,this.onSuccess(void 0)}),t>=0?t:this.defaultDelay)),this.completionPromise}forceDelivery(){if(!this.completionPromise)return;this.cancelTimeout();let e=this.task();return this.completionPromise=void 0,this.onSuccess=void 0,this.task=void 0,e}isTriggered(){return void 0!==this.timeout}cancel(){this.cancelTimeout(),this.completionPromise=void 0}cancelTimeout(){void 0!==this.timeout&&(Ge.RAL().timer.clearTimeout(this.timeout),this.timeout=void 0)}};var Je={};Object.defineProperty(Je,"__esModule",{value:!0}),Je.generateUuid=Je.parse=Je.isUUID=Je.v4=Je.empty=void 0;class Qe{constructor(e){this._value=e}asHex(){return this._value}equals(e){return this.asHex()===e.asHex()}}class Ze extends Qe{constructor(){super([Ze._randomHex(),Ze._randomHex(),Ze._randomHex(),Ze._randomHex(),Ze._randomHex(),Ze._randomHex(),Ze._randomHex(),Ze._randomHex(),"-",Ze._randomHex(),Ze._randomHex(),Ze._randomHex(),Ze._randomHex(),"-","4",Ze._randomHex(),Ze._randomHex(),Ze._randomHex(),"-",Ze._oneOf(Ze._timeHighBits),Ze._randomHex(),Ze._randomHex(),Ze._randomHex(),"-",Ze._randomHex(),Ze._randomHex(),Ze._randomHex(),Ze._randomHex(),Ze._randomHex(),Ze._randomHex(),Ze._randomHex(),Ze._randomHex(),Ze._randomHex(),Ze._randomHex(),Ze._randomHex(),Ze._randomHex()].join(""))}static _oneOf(e){return e[Math.floor(e.length*Math.random())]}static _randomHex(){return Ze._oneOf(Ze._chars)}}function Xe(){return new Ze}Ze._chars=["0","1","2","3","4","5","6","6","7","8","9","a","b","c","d","e","f"],Ze._timeHighBits=["8","9","a","b"],Je.empty=new Qe("00000000-0000-0000-0000-000000000000"),Je.v4=Xe;const Ye=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;function et(e){return Ye.test(e)}Je.isUUID=et,Je.parse=function(e){if(!et(e))throw new Error("invalid uuid");return new Qe(e)},Je.generateUuid=function(){return Xe().asHex()};var tt={};Object.defineProperty(tt,"__esModule",{value:!0}),tt.ProgressPart=void 0;const it=C,nt=a,ot=ne;tt.ProgressPart=class{constructor(e,t,i){this._client=e,this._token=t,this._reported=0,this._disposable=this._client.onProgress(nt.WorkDoneProgress.type,this._token,(e=>{switch(e.kind){case"begin":this.begin(e);break;case"report":this.report(e);break;case"end":this.done(),i&&i(this)}}))}begin(e){it.window.withProgress({location:it.ProgressLocation.Window,cancellable:e.cancellable,title:e.title},(async(t,i)=>(this._progress=t,this._infinite=void 0===e.percentage,this._cancellationToken=i,this._cancellationToken.onCancellationRequested((()=>{this._client.sendNotification(nt.WorkDoneProgressCancelNotification.type,{token:this._token})})),this.report(e),new Promise(((e,t)=>{this._resolve=e,this._reject=t})))))}report(e){if(this._infinite&&ot.string(e.message))this._progress.report({message:e.message});else if(ot.number(e.percentage)){let t=Math.max(0,Math.min(e.percentage,100)),i=Math.max(0,t-this._reported);this._progress.report({message:e.message,increment:i}),this._reported+=i}}cancel(){this._disposable&&(this._disposable.dispose(),this._disposable=void 0),this._reject&&(this._reject(),this._resolve=void 0,this._reject=void 0)}done(){this._disposable&&(this._disposable.dispose(),this._disposable=void 0),this._resolve&&(this._resolve(),this._resolve=void 0,this._reject=void 0)}},function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.BaseLanguageClient=e.MessageTransports=e.TextDocumentFeature=e.State=e.RevealOutputChannelOn=e.CloseAction=e.ErrorAction=void 0;const t=C,i=a,n=Z,o=ie,r=qe,s=ne,c=Ve,l=Je,d=tt;class u{error(e){i.RAL().console.error(e)}warn(e){i.RAL().console.warn(e)}info(e){i.RAL().console.info(e)}log(e){i.RAL().console.log(e)}}var g,h,p,m,f,v,y,D,_,S;(h=g=e.ErrorAction||(e.ErrorAction={}))[h.Continue=1]="Continue",h[h.Shutdown=2]="Shutdown",(m=p=e.CloseAction||(e.CloseAction={}))[m.DoNotRestart=1]="DoNotRestart",m[m.Restart=2]="Restart";class R{constructor(e,t){this.name=e,this.maxRestartCount=t,this.restarts=[]}error(e,t,i){return i&&i<=3?g.Continue:g.Shutdown}closed(){if(this.restarts.push(Date.now()),this.restarts.length<=this.maxRestartCount)return p.Restart;return this.restarts[this.restarts.length-1]-this.restarts[0]<=18e4?(t.window.showErrorMessage(`The ${this.name} server crashed ${this.maxRestartCount+1} times in the last 3 minutes. The server will not be restarted.`),p.DoNotRestart):(this.restarts.shift(),p.Restart)}}(v=f=e.RevealOutputChannelOn||(e.RevealOutputChannelOn={}))[v.Info=1]="Info",v[v.Warn=2]="Warn",v[v.Error=3]="Error",v[v.Never=4]="Never",(D=y=e.State||(e.State={}))[D.Stopped=1]="Stopped",D[D.Starting=3]="Starting",D[D.Running=2]="Running",(S=_||(_={}))[S.Initial=0]="Initial",S[S.Starting=1]="Starting",S[S.StartFailed=2]="StartFailed",S[S.Running=3]="Running",S[S.Stopping=4]="Stopping",S[S.Stopped=5]="Stopped";const w=[i.SymbolKind.File,i.SymbolKind.Module,i.SymbolKind.Namespace,i.SymbolKind.Package,i.SymbolKind.Class,i.SymbolKind.Method,i.SymbolKind.Property,i.SymbolKind.Field,i.SymbolKind.Constructor,i.SymbolKind.Enum,i.SymbolKind.Interface,i.SymbolKind.Function,i.SymbolKind.Variable,i.SymbolKind.Constant,i.SymbolKind.String,i.SymbolKind.Number,i.SymbolKind.Boolean,i.SymbolKind.Array,i.SymbolKind.Object,i.SymbolKind.Key,i.SymbolKind.Null,i.SymbolKind.EnumMember,i.SymbolKind.Struct,i.SymbolKind.Event,i.SymbolKind.Operator,i.SymbolKind.TypeParameter],T=[i.CompletionItemKind.Text,i.CompletionItemKind.Method,i.CompletionItemKind.Function,i.CompletionItemKind.Constructor,i.CompletionItemKind.Field,i.CompletionItemKind.Variable,i.CompletionItemKind.Class,i.CompletionItemKind.Interface,i.CompletionItemKind.Module,i.CompletionItemKind.Property,i.CompletionItemKind.Unit,i.CompletionItemKind.Value,i.CompletionItemKind.Enum,i.CompletionItemKind.Keyword,i.CompletionItemKind.Snippet,i.CompletionItemKind.Color,i.CompletionItemKind.File,i.CompletionItemKind.Reference,i.CompletionItemKind.Folder,i.CompletionItemKind.EnumMember,i.CompletionItemKind.Constant,i.CompletionItemKind.Struct,i.CompletionItemKind.Event,i.CompletionItemKind.Operator,i.CompletionItemKind.TypeParameter],x=[i.SymbolTag.Deprecated];function P(e,t){return void 0===e[t]&&(e[t]={}),e[t]}var b,k;(b||(b={})).fromConfiguration=function(e){const i=t.workspace.getConfiguration("files",e);return{trimTrailingWhitespace:i.get("trimTrailingWhitespace"),trimFinalNewlines:i.get("trimFinalNewlines"),insertFinalNewline:i.get("insertFinalNewline")}},(k||(k={})).is=function(e){let t=e;return t&&s.func(t.register)&&s.func(t.unregister)&&s.func(t.dispose)&&void 0!==t.registrationType};class O{constructor(e,t,i,n,o,r){this._client=e,this._event=t,this._type=i,this._middleware=n,this._createParams=o,this._selectorFilter=r,this._selectors=new Map}static textDocumentFilter(e,i){for(const n of e)if(t.languages.match(n,i))return!0;return!1}register(e){e.registerOptions.documentSelector&&(this._listener||(this._listener=this._event(this.callback,this)),this._selectors.set(e.id,e.registerOptions.documentSelector))}callback(e){this._selectorFilter&&!this._selectorFilter(this._selectors.values(),e)||(this._middleware?this._middleware(e,(e=>this._client.sendNotification(this._type,this._createParams(e)))):this._client.sendNotification(this._type,this._createParams(e)),this.notificationSent(e))}notificationSent(e){}unregister(e){this._selectors.delete(e),0===this._selectors.size&&this._listener&&(this._listener.dispose(),this._listener=void 0)}dispose(){this._selectors.clear(),this._listener&&(this._listener.dispose(),this._listener=void 0)}getProvider(e){for(const i of this._selectors.values())if(t.languages.match(i,e))return{send:e=>{this.callback(e)}}}}class F extends O{constructor(e,n){super(e,t.workspace.onDidOpenTextDocument,i.DidOpenTextDocumentNotification.type,e.clientOptions.middleware.didOpen,(t=>e.code2ProtocolConverter.asOpenTextDocumentParams(t)),O.textDocumentFilter),this._syncedDocuments=n}fillClientCapabilities(e){P(P(e,"textDocument"),"synchronization").dynamicRegistration=!0}initialize(e,t){let i=e.resolvedTextDocumentSync;t&&i&&i.openClose&&this.register({id:l.generateUuid(),registerOptions:{documentSelector:t}})}get registrationType(){return i.DidOpenTextDocumentNotification.type}register(e){if(super.register(e),!e.registerOptions.documentSelector)return;let i=e.registerOptions.documentSelector;t.workspace.textDocuments.forEach((e=>{let n=e.uri.toString();if(!this._syncedDocuments.has(n)&&t.languages.match(i,e)){let t=this._client.clientOptions.middleware,i=e=>{this._client.sendNotification(this._type,this._createParams(e))};t.didOpen?t.didOpen(e,i):i(e),this._syncedDocuments.set(n,e)}}))}notificationSent(e){super.notificationSent(e),this._syncedDocuments.set(e.uri.toString(),e)}}class E extends O{constructor(e,n){super(e,t.workspace.onDidCloseTextDocument,i.DidCloseTextDocumentNotification.type,e.clientOptions.middleware.didClose,(t=>e.code2ProtocolConverter.asCloseTextDocumentParams(t)),O.textDocumentFilter),this._syncedDocuments=n}get registrationType(){return i.DidCloseTextDocumentNotification.type}fillClientCapabilities(e){P(P(e,"textDocument"),"synchronization").dynamicRegistration=!0}initialize(e,t){let i=e.resolvedTextDocumentSync;t&&i&&i.openClose&&this.register({id:l.generateUuid(),registerOptions:{documentSelector:t}})}notificationSent(e){super.notificationSent(e),this._syncedDocuments.delete(e.uri.toString())}unregister(e){let i=this._selectors.get(e);super.unregister(e);let n=this._selectors.values();this._syncedDocuments.forEach((e=>{if(t.languages.match(i,e)&&!this._selectorFilter(n,e)){let t=this._client.clientOptions.middleware,i=e=>{this._client.sendNotification(this._type,this._createParams(e))};this._syncedDocuments.delete(e.uri.toString()),t.didClose?t.didClose(e,i):i(e)}}))}}class I{constructor(e){this._client=e,this._changeData=new Map,this._forcingDelivery=!1}get registrationType(){return i.DidChangeTextDocumentNotification.type}fillClientCapabilities(e){P(P(e,"textDocument"),"synchronization").dynamicRegistration=!0}initialize(e,t){let n=e.resolvedTextDocumentSync;t&&n&&void 0!==n.change&&n.change!==i.TextDocumentSyncKind.None&&this.register({id:l.generateUuid(),registerOptions:Object.assign({},{documentSelector:t},{syncKind:n.change})})}register(e){e.registerOptions.documentSelector&&(this._listener||(this._listener=t.workspace.onDidChangeTextDocument(this.callback,this)),this._changeData.set(e.id,{documentSelector:e.registerOptions.documentSelector,syncKind:e.registerOptions.syncKind}))}callback(e){if(0!==e.contentChanges.length)for(const n of this._changeData.values())if(t.languages.match(n.documentSelector,e.document)){let t=this._client.clientOptions.middleware;if(n.syncKind===i.TextDocumentSyncKind.Incremental){let n=this._client.code2ProtocolConverter.asChangeTextDocumentParams(e);t.didChange?t.didChange(e,(()=>this._client.sendNotification(i.DidChangeTextDocumentNotification.type,n))):this._client.sendNotification(i.DidChangeTextDocumentNotification.type,n)}else if(n.syncKind===i.TextDocumentSyncKind.Full){let n=e=>{this._changeDelayer?(this._changeDelayer.uri!==e.document.uri.toString()&&(this.forceDelivery(),this._changeDelayer.uri=e.document.uri.toString()),this._changeDelayer.delayer.trigger((()=>{this._client.sendNotification(i.DidChangeTextDocumentNotification.type,this._client.code2ProtocolConverter.asChangeTextDocumentParams(e.document))}))):(this._changeDelayer={uri:e.document.uri.toString(),delayer:new c.Delayer(200)},this._changeDelayer.delayer.trigger((()=>{this._client.sendNotification(i.DidChangeTextDocumentNotification.type,this._client.code2ProtocolConverter.asChangeTextDocumentParams(e.document))}),-1))};t.didChange?t.didChange(e,n):n(e)}}}unregister(e){this._changeData.delete(e),0===this._changeData.size&&this._listener&&(this._listener.dispose(),this._listener=void 0)}dispose(){this._changeDelayer=void 0,this._forcingDelivery=!1,this._changeData.clear(),this._listener&&(this._listener.dispose(),this._listener=void 0)}forceDelivery(){if(!this._forcingDelivery&&this._changeDelayer)try{this._forcingDelivery=!0,this._changeDelayer.delayer.forceDelivery()}finally{this._forcingDelivery=!1}}getProvider(e){for(const i of this._changeData.values())if(t.languages.match(i.documentSelector,e))return{send:e=>{this.callback(e)}}}}class M extends O{constructor(e){super(e,t.workspace.onWillSaveTextDocument,i.WillSaveTextDocumentNotification.type,e.clientOptions.middleware.willSave,(t=>e.code2ProtocolConverter.asWillSaveTextDocumentParams(t)),((e,t)=>O.textDocumentFilter(e,t.document)))}get registrationType(){return i.WillSaveTextDocumentNotification.type}fillClientCapabilities(e){P(P(e,"textDocument"),"synchronization").willSave=!0}initialize(e,t){let i=e.resolvedTextDocumentSync;t&&i&&i.willSave&&this.register({id:l.generateUuid(),registerOptions:{documentSelector:t}})}}class q{constructor(e){this._client=e,this._selectors=new Map}get registrationType(){return i.WillSaveTextDocumentWaitUntilRequest.type}fillClientCapabilities(e){P(P(e,"textDocument"),"synchronization").willSaveWaitUntil=!0}initialize(e,t){let i=e.resolvedTextDocumentSync;t&&i&&i.willSaveWaitUntil&&this.register({id:l.generateUuid(),registerOptions:{documentSelector:t}})}register(e){e.registerOptions.documentSelector&&(this._listener||(this._listener=t.workspace.onWillSaveTextDocument(this.callback,this)),this._selectors.set(e.id,e.registerOptions.documentSelector))}callback(e){if(O.textDocumentFilter(this._selectors.values(),e.document)){let t=this._client.clientOptions.middleware,n=e=>this._client.sendRequest(i.WillSaveTextDocumentWaitUntilRequest.type,this._client.code2ProtocolConverter.asWillSaveTextDocumentParams(e)).then((e=>{let t=this._client.protocol2CodeConverter.asTextEdits(e);return void 0===t?[]:t}));e.waitUntil(t.willSaveWaitUntil?t.willSaveWaitUntil(e,n):n(e))}}unregister(e){this._selectors.delete(e),0===this._selectors.size&&this._listener&&(this._listener.dispose(),this._listener=void 0)}dispose(){this._selectors.clear(),this._listener&&(this._listener.dispose(),this._listener=void 0)}}class L extends O{constructor(e){super(e,t.workspace.onDidSaveTextDocument,i.DidSaveTextDocumentNotification.type,e.clientOptions.middleware.didSave,(t=>e.code2ProtocolConverter.asSaveTextDocumentParams(t,this._includeText)),O.textDocumentFilter),this._includeText=!1}get registrationType(){return i.DidSaveTextDocumentNotification.type}fillClientCapabilities(e){P(P(e,"textDocument"),"synchronization").didSave=!0}initialize(e,t){const i=e.resolvedTextDocumentSync;if(t&&i&&i.save){const e="boolean"==typeof i.save?{includeText:!1}:{includeText:!!i.save.includeText};this.register({id:l.generateUuid(),registerOptions:Object.assign({},{documentSelector:t},e)})}}register(e){this._includeText=!!e.registerOptions.includeText,super.register(e)}}class H{constructor(e,t){this._client=e,this._notifyFileEvent=t,this._watchers=new Map}get registrationType(){return i.DidChangeWatchedFilesNotification.type}fillClientCapabilities(e){P(P(e,"workspace"),"didChangeWatchedFiles").dynamicRegistration=!0}initialize(e,t){}register(e){if(!Array.isArray(e.registerOptions.watchers))return;let n=[];for(let o of e.registerOptions.watchers){if(!s.string(o.globPattern))continue;let e=!0,r=!0,a=!0;void 0!==o.kind&&null!==o.kind&&(e=0!=(o.kind&i.WatchKind.Create),r=0!=(o.kind&i.WatchKind.Change),a=0!=(o.kind&i.WatchKind.Delete));let c=t.workspace.createFileSystemWatcher(o.globPattern,!e,!r,!a);this.hookListeners(c,e,r,a),n.push(c)}this._watchers.set(e.id,n)}registerRaw(e,t){let i=[];for(let n of t)this.hookListeners(n,!0,!0,!0,i);this._watchers.set(e,i)}hookListeners(e,t,n,o,r){t&&e.onDidCreate((e=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(e),type:i.FileChangeType.Created})),null,r),n&&e.onDidChange((e=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(e),type:i.FileChangeType.Changed})),null,r),o&&e.onDidDelete((e=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(e),type:i.FileChangeType.Deleted})),null,r)}unregister(e){let t=this._watchers.get(e);if(t)for(let i of t)i.dispose()}dispose(){this._watchers.forEach((e=>{for(let t of e)t.dispose()})),this._watchers.clear()}}class K{constructor(e,t){this._client=e,this._registrationType=t,this._registrations=new Map}get registrationType(){return this._registrationType}register(e){if(!e.registerOptions.documentSelector)return;let t=this.registerLanguageProvider(e.registerOptions);this._registrations.set(e.id,{disposable:t[0],data:e,provider:t[1]})}unregister(e){let t=this._registrations.get(e);void 0!==t&&t.disposable.dispose()}dispose(){this._registrations.forEach((e=>{e.disposable.dispose()})),this._registrations.clear()}getRegistration(e,t){if(!t)return[void 0,void 0];if(i.TextDocumentRegistrationOptions.is(t)){const n=i.StaticRegistrationOptions.hasId(t)?t.id:l.generateUuid(),o=t.documentSelector||e;if(o)return[n,Object.assign({},t,{documentSelector:o})]}else if(s.boolean(t)&&!0===t||i.WorkDoneProgressOptions.is(t)){if(!e)return[void 0,void 0];let i=s.boolean(t)&&!0===t?{documentSelector:e}:Object.assign({},t,{documentSelector:e});return[l.generateUuid(),i]}return[void 0,void 0]}getRegistrationOptions(e,t){if(e&&t)return s.boolean(t)&&!0===t?{documentSelector:e}:Object.assign({},t,{documentSelector:e})}getProvider(e){for(const i of this._registrations.values()){let n=i.data.registerOptions.documentSelector;if(null!==n&&t.languages.match(n,e))return i.provider}}getAllProviders(){const e=[];for(const t of this._registrations.values())e.push(t.provider);return e}}e.TextDocumentFeature=K;class A extends K{constructor(e){super(e,i.CompletionRequest.type)}fillClientCapabilities(e){let t=P(P(e,"textDocument"),"completion");t.dynamicRegistration=!0,t.contextSupport=!0,t.completionItem={snippetSupport:!0,commitCharactersSupport:!0,documentationFormat:[i.MarkupKind.Markdown,i.MarkupKind.PlainText],deprecatedSupport:!0,preselectSupport:!0,tagSupport:{valueSet:[i.CompletionItemTag.Deprecated]},insertReplaceSupport:!0,resolveSupport:{properties:["documentation","detail","additionalTextEdits"]},insertTextModeSupport:{valueSet:[i.InsertTextMode.asIs,i.InsertTextMode.adjustIndentation]}},t.completionItemKind={valueSet:T}}initialize(e,t){const i=this.getRegistrationOptions(t,e.completionProvider);i&&this.register({id:l.generateUuid(),registerOptions:i})}registerLanguageProvider(e){const n=e.triggerCharacters||[],o={provideCompletionItems:(e,t,n,o)=>{const r=this._client,s=this._client.clientOptions.middleware,a=(e,t,n,o)=>r.sendRequest(i.CompletionRequest.type,r.code2ProtocolConverter.asCompletionParams(e,t,n),o).then(r.protocol2CodeConverter.asCompletionResult,(e=>r.handleFailedRequest(i.CompletionRequest.type,e,null)));return s.provideCompletionItem?s.provideCompletionItem(e,t,o,n,a):a(e,t,o,n)},resolveCompletionItem:e.resolveProvider?(e,t)=>{const n=this._client,o=this._client.clientOptions.middleware,r=(e,t)=>n.sendRequest(i.CompletionResolveRequest.type,n.code2ProtocolConverter.asCompletionItem(e),t).then(n.protocol2CodeConverter.asCompletionItem,(t=>n.handleFailedRequest(i.CompletionResolveRequest.type,t,e)));return o.resolveCompletionItem?o.resolveCompletionItem(e,t,r):r(e,t)}:void 0};return[t.languages.registerCompletionItemProvider(e.documentSelector,o,...n),o]}}class N extends K{constructor(e){super(e,i.HoverRequest.type)}fillClientCapabilities(e){const t=P(P(e,"textDocument"),"hover");t.dynamicRegistration=!0,t.contentFormat=[i.MarkupKind.Markdown,i.MarkupKind.PlainText]}initialize(e,t){const i=this.getRegistrationOptions(t,e.hoverProvider);i&&this.register({id:l.generateUuid(),registerOptions:i})}registerLanguageProvider(e){const n={provideHover:(e,t,n)=>{const o=this._client,r=(e,t,n)=>o.sendRequest(i.HoverRequest.type,o.code2ProtocolConverter.asTextDocumentPositionParams(e,t),n).then(o.protocol2CodeConverter.asHover,(e=>o.handleFailedRequest(i.HoverRequest.type,e,null))),s=o.clientOptions.middleware;return s.provideHover?s.provideHover(e,t,n,r):r(e,t,n)}};return[t.languages.registerHoverProvider(e.documentSelector,n),n]}}class W extends K{constructor(e){super(e,i.SignatureHelpRequest.type)}fillClientCapabilities(e){let t=P(P(e,"textDocument"),"signatureHelp");t.dynamicRegistration=!0,t.signatureInformation={documentationFormat:[i.MarkupKind.Markdown,i.MarkupKind.PlainText]},t.signatureInformation.parameterInformation={labelOffsetSupport:!0},t.signatureInformation.activeParameterSupport=!0,t.contextSupport=!0}initialize(e,t){const i=this.getRegistrationOptions(t,e.signatureHelpProvider);i&&this.register({id:l.generateUuid(),registerOptions:i})}registerLanguageProvider(e){const n={provideSignatureHelp:(e,t,n,o)=>{const r=this._client,s=(e,t,n,o)=>r.sendRequest(i.SignatureHelpRequest.type,r.code2ProtocolConverter.asSignatureHelpParams(e,t,n),o).then(r.protocol2CodeConverter.asSignatureHelp,(e=>r.handleFailedRequest(i.SignatureHelpRequest.type,e,null))),a=r.clientOptions.middleware;return a.provideSignatureHelp?a.provideSignatureHelp(e,t,o,n,s):s(e,t,o,n)}};let o;if(void 0===e.retriggerCharacters){const i=e.triggerCharacters||[];o=t.languages.registerSignatureHelpProvider(e.documentSelector,n,...i)}else{const i={triggerCharacters:e.triggerCharacters||[],retriggerCharacters:e.retriggerCharacters||[]};o=t.languages.registerSignatureHelpProvider(e.documentSelector,n,i)}return[o,n]}}class U extends K{constructor(e){super(e,i.DefinitionRequest.type)}fillClientCapabilities(e){let t=P(P(e,"textDocument"),"definition");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){const i=this.getRegistrationOptions(t,e.definitionProvider);i&&this.register({id:l.generateUuid(),registerOptions:i})}registerLanguageProvider(e){const n={provideDefinition:(e,t,n)=>{const o=this._client,r=(e,t,n)=>o.sendRequest(i.DefinitionRequest.type,o.code2ProtocolConverter.asTextDocumentPositionParams(e,t),n).then(o.protocol2CodeConverter.asDefinitionResult,(e=>o.handleFailedRequest(i.DefinitionRequest.type,e,null))),s=o.clientOptions.middleware;return s.provideDefinition?s.provideDefinition(e,t,n,r):r(e,t,n)}};return[t.languages.registerDefinitionProvider(e.documentSelector,n),n]}}class z extends K{constructor(e){super(e,i.ReferencesRequest.type)}fillClientCapabilities(e){P(P(e,"textDocument"),"references").dynamicRegistration=!0}initialize(e,t){const i=this.getRegistrationOptions(t,e.referencesProvider);i&&this.register({id:l.generateUuid(),registerOptions:i})}registerLanguageProvider(e){const n={provideReferences:(e,t,n,o)=>{const r=this._client,s=(e,t,n,o)=>r.sendRequest(i.ReferencesRequest.type,r.code2ProtocolConverter.asReferenceParams(e,t,n),o).then(r.protocol2CodeConverter.asReferences,(e=>r.handleFailedRequest(i.ReferencesRequest.type,e,null))),a=r.clientOptions.middleware;return a.provideReferences?a.provideReferences(e,t,n,o,s):s(e,t,n,o)}};return[t.languages.registerReferenceProvider(e.documentSelector,n),n]}}class j extends K{constructor(e){super(e,i.DocumentHighlightRequest.type)}fillClientCapabilities(e){P(P(e,"textDocument"),"documentHighlight").dynamicRegistration=!0}initialize(e,t){const i=this.getRegistrationOptions(t,e.documentHighlightProvider);i&&this.register({id:l.generateUuid(),registerOptions:i})}registerLanguageProvider(e){const n={provideDocumentHighlights:(e,t,n)=>{const o=this._client,r=(e,t,n)=>o.sendRequest(i.DocumentHighlightRequest.type,o.code2ProtocolConverter.asTextDocumentPositionParams(e,t),n).then(o.protocol2CodeConverter.asDocumentHighlights,(e=>o.handleFailedRequest(i.DocumentHighlightRequest.type,e,null))),s=o.clientOptions.middleware;return s.provideDocumentHighlights?s.provideDocumentHighlights(e,t,n,r):r(e,t,n)}};return[t.languages.registerDocumentHighlightProvider(e.documentSelector,n),n]}}class $ extends K{constructor(e){super(e,i.DocumentSymbolRequest.type)}fillClientCapabilities(e){let t=P(P(e,"textDocument"),"documentSymbol");t.dynamicRegistration=!0,t.symbolKind={valueSet:w},t.hierarchicalDocumentSymbolSupport=!0,t.tagSupport={valueSet:x},t.labelSupport=!0}initialize(e,t){const i=this.getRegistrationOptions(t,e.documentSymbolProvider);i&&this.register({id:l.generateUuid(),registerOptions:i})}registerLanguageProvider(e){const n={provideDocumentSymbols:(e,t)=>{const n=this._client,o=(e,t)=>n.sendRequest(i.DocumentSymbolRequest.type,n.code2ProtocolConverter.asDocumentSymbolParams(e),t).then((e=>{if(null!==e){if(0===e.length)return[];{let t=e[0];return i.DocumentSymbol.is(t)?n.protocol2CodeConverter.asDocumentSymbols(e):n.protocol2CodeConverter.asSymbolInformations(e)}}}),(e=>n.handleFailedRequest(i.DocumentSymbolRequest.type,e,null))),r=n.clientOptions.middleware;return r.provideDocumentSymbols?r.provideDocumentSymbols(e,t,o):o(e,t)}},o=void 0!==e.label?{label:e.label}:void 0;return[t.languages.registerDocumentSymbolProvider(e.documentSelector,n,o),n]}}class B extends class{constructor(e,t){this._client=e,this._registrationType=t,this._registrations=new Map}get registrationType(){return this._registrationType}register(e){const t=this.registerLanguageProvider(e.registerOptions);this._registrations.set(e.id,{disposable:t[0],provider:t[1]})}unregister(e){let t=this._registrations.get(e);void 0!==t&&t.disposable.dispose()}dispose(){this._registrations.forEach((e=>{e.disposable.dispose()})),this._registrations.clear()}getProviders(){const e=[];for(const t of this._registrations.values())e.push(t.provider);return e}}{constructor(e){super(e,i.WorkspaceSymbolRequest.type)}fillClientCapabilities(e){let t=P(P(e,"workspace"),"symbol");t.dynamicRegistration=!0,t.symbolKind={valueSet:w},t.tagSupport={valueSet:x}}initialize(e){e.workspaceSymbolProvider&&this.register({id:l.generateUuid(),registerOptions:!0===e.workspaceSymbolProvider?{workDoneProgress:!1}:e.workspaceSymbolProvider})}registerLanguageProvider(e){const n={provideWorkspaceSymbols:(e,t)=>{const n=this._client,o=(e,t)=>n.sendRequest(i.WorkspaceSymbolRequest.type,{query:e},t).then(n.protocol2CodeConverter.asSymbolInformations,(e=>n.handleFailedRequest(i.WorkspaceSymbolRequest.type,e,null))),r=n.clientOptions.middleware;return r.provideWorkspaceSymbols?r.provideWorkspaceSymbols(e,t,o):o(e,t)}};return[t.languages.registerWorkspaceSymbolProvider(n),n]}}class V extends K{constructor(e){super(e,i.CodeActionRequest.type)}fillClientCapabilities(e){const t=P(P(e,"textDocument"),"codeAction");t.dynamicRegistration=!0,t.isPreferredSupport=!0,t.disabledSupport=!0,t.dataSupport=!0,t.resolveSupport={properties:["edit"]},t.codeActionLiteralSupport={codeActionKind:{valueSet:[i.CodeActionKind.Empty,i.CodeActionKind.QuickFix,i.CodeActionKind.Refactor,i.CodeActionKind.RefactorExtract,i.CodeActionKind.RefactorInline,i.CodeActionKind.RefactorRewrite,i.CodeActionKind.Source,i.CodeActionKind.SourceOrganizeImports]}},t.honorsChangeAnnotations=!1}initialize(e,t){const i=this.getRegistrationOptions(t,e.codeActionProvider);i&&this.register({id:l.generateUuid(),registerOptions:i})}registerLanguageProvider(e){const n={provideCodeActions:(e,t,n,o)=>{const r=this._client,s=(e,t,n,o)=>{const s={textDocument:r.code2ProtocolConverter.asTextDocumentIdentifier(e),range:r.code2ProtocolConverter.asRange(t),context:r.code2ProtocolConverter.asCodeActionContext(n)};return r.sendRequest(i.CodeActionRequest.type,s,o).then((e=>{if(null===e)return;const t=[];for(let n of e)i.Command.is(n)?t.push(r.protocol2CodeConverter.asCommand(n)):t.push(r.protocol2CodeConverter.asCodeAction(n));return t}),(e=>r.handleFailedRequest(i.CodeActionRequest.type,e,null)))},a=r.clientOptions.middleware;return a.provideCodeActions?a.provideCodeActions(e,t,n,o,s):s(e,t,n,o)},resolveCodeAction:e.resolveProvider?(e,t)=>{const n=this._client,o=this._client.clientOptions.middleware,r=(e,t)=>n.sendRequest(i.CodeActionResolveRequest.type,n.code2ProtocolConverter.asCodeAction(e),t).then(n.protocol2CodeConverter.asCodeAction,(t=>n.handleFailedRequest(i.CodeActionResolveRequest.type,t,e)));return o.resolveCodeAction?o.resolveCodeAction(e,t,r):r(e,t)}:void 0};return[t.languages.registerCodeActionsProvider(e.documentSelector,n,e.codeActionKinds?{providedCodeActionKinds:this._client.protocol2CodeConverter.asCodeActionKinds(e.codeActionKinds)}:void 0),n]}}class G extends K{constructor(e){super(e,i.CodeLensRequest.type)}fillClientCapabilities(e){P(P(e,"textDocument"),"codeLens").dynamicRegistration=!0,P(P(e,"workspace"),"codeLens").refreshSupport=!0}initialize(e,t){this._client.onRequest(i.CodeLensRefreshRequest.type,(async()=>{for(const e of this.getAllProviders())e.onDidChangeCodeLensEmitter.fire()}));const n=this.getRegistrationOptions(t,e.codeLensProvider);n&&this.register({id:l.generateUuid(),registerOptions:n})}registerLanguageProvider(e){const n=new t.EventEmitter,o={onDidChangeCodeLenses:n.event,provideCodeLenses:(e,t)=>{const n=this._client,o=(e,t)=>n.sendRequest(i.CodeLensRequest.type,n.code2ProtocolConverter.asCodeLensParams(e),t).then(n.protocol2CodeConverter.asCodeLenses,(e=>n.handleFailedRequest(i.CodeLensRequest.type,e,null))),r=n.clientOptions.middleware;return r.provideCodeLenses?r.provideCodeLenses(e,t,o):o(e,t)},resolveCodeLens:e.resolveProvider?(e,t)=>{const n=this._client,o=(e,t)=>n.sendRequest(i.CodeLensResolveRequest.type,n.code2ProtocolConverter.asCodeLens(e),t).then(n.protocol2CodeConverter.asCodeLens,(t=>n.handleFailedRequest(i.CodeLensResolveRequest.type,t,e))),r=n.clientOptions.middleware;return r.resolveCodeLens?r.resolveCodeLens(e,t,o):o(e,t)}:void 0};return[t.languages.registerCodeLensProvider(e.documentSelector,o),{provider:o,onDidChangeCodeLensEmitter:n}]}}class J extends K{constructor(e){super(e,i.DocumentFormattingRequest.type)}fillClientCapabilities(e){P(P(e,"textDocument"),"formatting").dynamicRegistration=!0}initialize(e,t){const i=this.getRegistrationOptions(t,e.documentFormattingProvider);i&&this.register({id:l.generateUuid(),registerOptions:i})}registerLanguageProvider(e){const n={provideDocumentFormattingEdits:(e,t,n)=>{const o=this._client,r=(e,t,n)=>{const r={textDocument:o.code2ProtocolConverter.asTextDocumentIdentifier(e),options:o.code2ProtocolConverter.asFormattingOptions(t,b.fromConfiguration(e))};return o.sendRequest(i.DocumentFormattingRequest.type,r,n).then(o.protocol2CodeConverter.asTextEdits,(e=>o.handleFailedRequest(i.DocumentFormattingRequest.type,e,null)))},s=o.clientOptions.middleware;return s.provideDocumentFormattingEdits?s.provideDocumentFormattingEdits(e,t,n,r):r(e,t,n)}};return[t.languages.registerDocumentFormattingEditProvider(e.documentSelector,n),n]}}class Q extends K{constructor(e){super(e,i.DocumentRangeFormattingRequest.type)}fillClientCapabilities(e){P(P(e,"textDocument"),"rangeFormatting").dynamicRegistration=!0}initialize(e,t){const i=this.getRegistrationOptions(t,e.documentRangeFormattingProvider);i&&this.register({id:l.generateUuid(),registerOptions:i})}registerLanguageProvider(e){const n={provideDocumentRangeFormattingEdits:(e,t,n,o)=>{const r=this._client,s=(e,t,n,o)=>{const s={textDocument:r.code2ProtocolConverter.asTextDocumentIdentifier(e),range:r.code2ProtocolConverter.asRange(t),options:r.code2ProtocolConverter.asFormattingOptions(n,b.fromConfiguration(e))};return r.sendRequest(i.DocumentRangeFormattingRequest.type,s,o).then(r.protocol2CodeConverter.asTextEdits,(e=>r.handleFailedRequest(i.DocumentRangeFormattingRequest.type,e,null)))},a=r.clientOptions.middleware;return a.provideDocumentRangeFormattingEdits?a.provideDocumentRangeFormattingEdits(e,t,n,o,s):s(e,t,n,o)}};return[t.languages.registerDocumentRangeFormattingEditProvider(e.documentSelector,n),n]}}class X extends K{constructor(e){super(e,i.DocumentOnTypeFormattingRequest.type)}fillClientCapabilities(e){P(P(e,"textDocument"),"onTypeFormatting").dynamicRegistration=!0}initialize(e,t){const i=this.getRegistrationOptions(t,e.documentOnTypeFormattingProvider);i&&this.register({id:l.generateUuid(),registerOptions:i})}registerLanguageProvider(e){const n={provideOnTypeFormattingEdits:(e,t,n,o,r)=>{const s=this._client,a=(e,t,n,o,r)=>{let a={textDocument:s.code2ProtocolConverter.asTextDocumentIdentifier(e),position:s.code2ProtocolConverter.asPosition(t),ch:n,options:s.code2ProtocolConverter.asFormattingOptions(o,b.fromConfiguration(e))};return s.sendRequest(i.DocumentOnTypeFormattingRequest.type,a,r).then(s.protocol2CodeConverter.asTextEdits,(e=>s.handleFailedRequest(i.DocumentOnTypeFormattingRequest.type,e,null)))},c=s.clientOptions.middleware;return c.provideOnTypeFormattingEdits?c.provideOnTypeFormattingEdits(e,t,n,o,r,a):a(e,t,n,o,r)}},o=e.moreTriggerCharacter||[];return[t.languages.registerOnTypeFormattingEditProvider(e.documentSelector,n,e.firstTriggerCharacter,...o),n]}}class Y extends K{constructor(e){super(e,i.RenameRequest.type)}fillClientCapabilities(e){let t=P(P(e,"textDocument"),"rename");t.dynamicRegistration=!0,t.prepareSupport=!0,t.prepareSupportDefaultBehavior=i.PrepareSupportDefaultBehavior.Identifier,t.honorsChangeAnnotations=!0}initialize(e,t){const i=this.getRegistrationOptions(t,e.renameProvider);i&&(s.boolean(e.renameProvider)&&(i.prepareProvider=!1),this.register({id:l.generateUuid(),registerOptions:i}))}registerLanguageProvider(e){const n={provideRenameEdits:(e,t,n,o)=>{const r=this._client,s=(e,t,n,o)=>{let s={textDocument:r.code2ProtocolConverter.asTextDocumentIdentifier(e),position:r.code2ProtocolConverter.asPosition(t),newName:n};return r.sendRequest(i.RenameRequest.type,s,o).then(r.protocol2CodeConverter.asWorkspaceEdit,(e=>r.handleFailedRequest(i.RenameRequest.type,e,null)))},a=r.clientOptions.middleware;return a.provideRenameEdits?a.provideRenameEdits(e,t,n,o,s):s(e,t,n,o)},prepareRename:e.prepareProvider?(e,t,n)=>{const o=this._client,r=(e,t,n)=>{let r={textDocument:o.code2ProtocolConverter.asTextDocumentIdentifier(e),position:o.code2ProtocolConverter.asPosition(t)};return o.sendRequest(i.PrepareRenameRequest.type,r,n).then((e=>i.Range.is(e)?o.protocol2CodeConverter.asRange(e):this.isDefaultBehavior(e)?!0===e.defaultBehavior?null:Promise.reject(new Error("The element can't be renamed.")):e&&i.Range.is(e.range)?{range:o.protocol2CodeConverter.asRange(e.range),placeholder:e.placeholder}:Promise.reject(new Error("The element can't be renamed."))),(e=>o.handleFailedRequest(i.PrepareRenameRequest.type,e,void 0)))},s=o.clientOptions.middleware;return s.prepareRename?s.prepareRename(e,t,n,r):r(e,t,n)}:void 0};return[t.languages.registerRenameProvider(e.documentSelector,n),n]}isDefaultBehavior(e){const t=e;return t&&s.boolean(t.defaultBehavior)}}class ee extends K{constructor(e){super(e,i.DocumentLinkRequest.type)}fillClientCapabilities(e){const t=P(P(e,"textDocument"),"documentLink");t.dynamicRegistration=!0,t.tooltipSupport=!0}initialize(e,t){const i=this.getRegistrationOptions(t,e.documentLinkProvider);i&&this.register({id:l.generateUuid(),registerOptions:i})}registerLanguageProvider(e){const n={provideDocumentLinks:(e,t)=>{const n=this._client,o=(e,t)=>n.sendRequest(i.DocumentLinkRequest.type,n.code2ProtocolConverter.asDocumentLinkParams(e),t).then(n.protocol2CodeConverter.asDocumentLinks,(e=>n.handleFailedRequest(i.DocumentLinkRequest.type,e,null))),r=n.clientOptions.middleware;return r.provideDocumentLinks?r.provideDocumentLinks(e,t,o):o(e,t)},resolveDocumentLink:e.resolveProvider?(e,t)=>{const n=this._client;let o=(e,t)=>n.sendRequest(i.DocumentLinkResolveRequest.type,n.code2ProtocolConverter.asDocumentLink(e),t).then(n.protocol2CodeConverter.asDocumentLink,(t=>n.handleFailedRequest(i.DocumentLinkResolveRequest.type,t,e)));const r=n.clientOptions.middleware;return r.resolveDocumentLink?r.resolveDocumentLink(e,t,o):o(e,t)}:void 0};return[t.languages.registerDocumentLinkProvider(e.documentSelector,n),n]}}class te{constructor(e){this._client=e,this._listeners=new Map}get registrationType(){return i.DidChangeConfigurationNotification.type}fillClientCapabilities(e){P(P(e,"workspace"),"didChangeConfiguration").dynamicRegistration=!0}initialize(){let e=this._client.clientOptions.synchronize.configurationSection;void 0!==e&&this.register({id:l.generateUuid(),registerOptions:{section:e}})}register(e){let i=t.workspace.onDidChangeConfiguration((t=>{this.onDidChangeConfiguration(e.registerOptions.section,t)}));this._listeners.set(e.id,i),void 0!==e.registerOptions.section&&this.onDidChangeConfiguration(e.registerOptions.section,void 0)}unregister(e){let t=this._listeners.get(e);t&&(this._listeners.delete(e),t.dispose())}dispose(){for(let e of this._listeners.values())e.dispose();this._listeners.clear()}onDidChangeConfiguration(e,t){let n;if(n=s.string(e)?[e]:e,void 0!==n&&void 0!==t){if(!n.some((e=>t.affectsConfiguration(e))))return}let o=e=>{void 0!==e?this._client.sendNotification(i.DidChangeConfigurationNotification.type,{settings:this.extractSettingsInformation(e)}):this._client.sendNotification(i.DidChangeConfigurationNotification.type,{settings:null})},r=this.getMiddleware();r?r(n,o):o(n)}extractSettingsInformation(e){function i(e,t){let i=e;for(let n=0;n<t.length-1;n++){let e=i[t[n]];e||(e=Object.create(null),i[t[n]]=e),i=e}return i}let o=this._client.clientOptions.workspaceFolder?this._client.clientOptions.workspaceFolder.uri:void 0,r=Object.create(null);for(let s=0;s<e.length;s++){let a=e[s],c=a.indexOf("."),l=null;if(l=c>=0?t.workspace.getConfiguration(a.substr(0,c),o).get(a.substr(c+1)):t.workspace.getConfiguration(void 0,o).get(a),l){let t=e[s].split(".");i(r,t)[t[t.length-1]]=n.toJSONObject(l)}}return r}getMiddleware(){let e=this._client.clientOptions.middleware;return e.workspace&&e.workspace.didChangeConfiguration?e.workspace.didChangeConfiguration:void 0}}class oe{constructor(e){this._client=e,this._commands=new Map}get registrationType(){return i.ExecuteCommandRequest.type}fillClientCapabilities(e){P(P(e,"workspace"),"executeCommand").dynamicRegistration=!0}initialize(e){e.executeCommandProvider&&this.register({id:l.generateUuid(),registerOptions:Object.assign({},e.executeCommandProvider)})}register(e){const n=this._client,o=n.clientOptions.middleware,r=(e,t)=>{let o={command:e,arguments:t};return n.sendRequest(i.ExecuteCommandRequest.type,o).then(void 0,(e=>n.handleFailedRequest(i.ExecuteCommandRequest.type,e,void 0)))};if(e.registerOptions.commands){const i=[];for(const n of e.registerOptions.commands)i.push(t.commands.registerCommand(n,((...e)=>o.executeCommand?o.executeCommand(n,e,r):r(n,e))));this._commands.set(e.id,i)}}unregister(e){let t=this._commands.get(e);t&&t.forEach((e=>e.dispose()))}dispose(){this._commands.forEach((e=>{e.forEach((e=>e.dispose()))})),this._commands.clear()}}(e.MessageTransports||(e.MessageTransports={})).is=function(e){return e&&i.MessageReader.is(e.reader)&&i.MessageWriter.is(e.writer)};class re{constructor(e,t){this._resolve=e,this._reject=t,this._used=!1}get isUsed(){return this._used}resolve(){this._used=!0,this._resolve()}reject(e){this._used=!0,this._reject(e)}}class se{constructor(e,t,n){var a;this._traceFormat=i.TraceFormat.Text,this._features=[],this._dynamicFeatures=new Map,this._id=e,this._name=t;const l={isTrusted:!1};void 0!==(n=n||{}).markdown&&!0===n.markdown.isTrusted&&(l.isTrusted=!0),this._clientOptions={documentSelector:n.documentSelector||[],synchronize:n.synchronize||{},diagnosticCollectionName:n.diagnosticCollectionName,outputChannelName:n.outputChannelName||this._name,revealOutputChannelOn:n.revealOutputChannelOn||f.Error,stdioEncoding:n.stdioEncoding||"utf8",initializationOptions:n.initializationOptions,initializationFailedHandler:n.initializationFailedHandler,progressOnInitialization:!!n.progressOnInitialization,errorHandler:n.errorHandler||this.createDefaultErrorHandler(null===(a=n.connectionOptions)||void 0===a?void 0:a.maxRestartCount),middleware:n.middleware||{},uriConverters:n.uriConverters,workspaceFolder:n.workspaceFolder,connectionOptions:n.connectionOptions,markdown:l},this._clientOptions.synchronize=this._clientOptions.synchronize||{},this._state=_.Initial,this._connectionPromise=void 0,this._resolvedConnection=void 0,this._initializeResult=void 0,n.outputChannel?(this._outputChannel=n.outputChannel,this._disposeOutputChannel=!1):(this._outputChannel=void 0,this._disposeOutputChannel=!0),this._traceOutputChannel=n.traceOutputChannel,this._listeners=void 0,this._providers=void 0,this._diagnostics=void 0,this._fileEvents=[],this._fileEventDelayer=new c.Delayer(250),this._onReady=new Promise(((e,t)=>{this._onReadyCallbacks=new re(e,t)})),this._onStop=void 0,this._telemetryEmitter=new i.Emitter,this._stateChangeEmitter=new i.Emitter,this._trace=i.Trace.Off,this._tracer={log:(e,t)=>{s.string(e)?this.logTrace(e,t):this.logObjectTrace(e)}},this._c2p=o.createConverter(n.uriConverters?n.uriConverters.code2Protocol:void 0),this._p2c=r.createConverter(n.uriConverters?n.uriConverters.protocol2Code:void 0,this._clientOptions.markdown.isTrusted),this._syncedDocuments=new Map,this.registerBuiltinFeatures()}get state(){return this._state}set state(e){let t=this.getPublicState();this._state=e;let i=this.getPublicState();i!==t&&this._stateChangeEmitter.fire({oldState:t,newState:i})}getPublicState(){return this.state===_.Running?y.Running:this.state===_.Starting?y.Starting:y.Stopped}get initializeResult(){return this._initializeResult}sendRequest(e,...t){if(!this.isConnectionActive())throw new Error("Language client is not ready yet");this.forceDocumentSync();try{return this._resolvedConnection.sendRequest(e,...t)}catch(i){throw this.error(`Sending request ${s.string(e)?e:e.method} failed.`,i),i}}onRequest(e,t){if(!this.isConnectionActive())throw new Error("Language client is not ready yet");try{return this._resolvedConnection.onRequest(e,t)}catch(i){throw this.error(`Registering request handler ${s.string(e)?e:e.method} failed.`,i),i}}sendNotification(e,t){if(!this.isConnectionActive())throw new Error("Language client is not ready yet");this.forceDocumentSync();try{this._resolvedConnection.sendNotification(e,t)}catch(i){throw this.error(`Sending notification ${s.string(e)?e:e.method} failed.`,i),i}}onNotification(e,t){if(!this.isConnectionActive())throw new Error("Language client is not ready yet");try{return this._resolvedConnection.onNotification(e,t)}catch(i){throw this.error(`Registering notification handler ${s.string(e)?e:e.method} failed.`,i),i}}onProgress(e,t,n){if(!this.isConnectionActive())throw new Error("Language client is not ready yet");try{if(i.WorkDoneProgress.is(e)){const i=this._clientOptions.middleware.handleWorkDoneProgress;if(void 0!==i)return this._resolvedConnection.onProgress(e,t,(e=>{i(t,e,(()=>n(e)))}))}return this._resolvedConnection.onProgress(e,t,n)}catch(o){throw this.error(`Registering progress handler for token ${t} failed.`,o),o}}sendProgress(e,t,i){if(!this.isConnectionActive())throw new Error("Language client is not ready yet");this.forceDocumentSync();try{this._resolvedConnection.sendProgress(e,t,i)}catch(n){throw this.error(`Sending progress for token ${t} failed.`,n),n}}get clientOptions(){return this._clientOptions}get protocol2CodeConverter(){return this._p2c}get code2ProtocolConverter(){return this._c2p}get onTelemetry(){return this._telemetryEmitter.event}get onDidChangeState(){return this._stateChangeEmitter.event}get outputChannel(){return this._outputChannel||(this._outputChannel=t.window.createOutputChannel(this._clientOptions.outputChannelName?this._clientOptions.outputChannelName:this._name)),this._outputChannel}get traceOutputChannel(){return this._traceOutputChannel?this._traceOutputChannel:this.outputChannel}get diagnostics(){return this._diagnostics}createDefaultErrorHandler(e){if(void 0!==e&&e<0)throw new Error(`Invalid maxRestartCount: ${e}`);return new R(this._name,null!=e?e:4)}set trace(e){this._trace=e,this.onReady().then((()=>{this.resolveConnection().then((e=>{e.trace(this._trace,this._tracer,{sendNotification:!1,traceFormat:this._traceFormat})}))}),(()=>{}))}data2String(e){if(e instanceof i.ResponseError){const t=e;return`  Message: ${t.message}\n  Code: ${t.code} ${t.data?"\n"+t.data.toString():""}`}return e instanceof Error?s.string(e.stack)?e.stack:e.message:s.string(e)?e:e.toString()}info(e,t,i=!0){this.outputChannel.appendLine(`[Info  - ${(new Date).toLocaleTimeString()}] ${e}`),t&&this.outputChannel.appendLine(this.data2String(t)),i&&this._clientOptions.revealOutputChannelOn<=f.Info&&this.showNotificationMessage()}warn(e,t,i=!0){this.outputChannel.appendLine(`[Warn  - ${(new Date).toLocaleTimeString()}] ${e}`),t&&this.outputChannel.appendLine(this.data2String(t)),i&&this._clientOptions.revealOutputChannelOn<=f.Warn&&this.showNotificationMessage()}error(e,t,i=!0){this.outputChannel.appendLine(`[Error - ${(new Date).toLocaleTimeString()}] ${e}`),t&&this.outputChannel.appendLine(this.data2String(t)),i&&this._clientOptions.revealOutputChannelOn<=f.Error&&this.showNotificationMessage()}showNotificationMessage(){t.window.showInformationMessage("A request has failed. See the output for more information.","Go to output").then((()=>{this.outputChannel.show(!0)}))}logTrace(e,t){this.traceOutputChannel.appendLine(`[Trace - ${(new Date).toLocaleTimeString()}] ${e}`),t&&this.traceOutputChannel.appendLine(this.data2String(t))}logObjectTrace(e){e.isLSPMessage&&e.type?this.traceOutputChannel.append(`[LSP   - ${(new Date).toLocaleTimeString()}] `):this.traceOutputChannel.append(`[Trace - ${(new Date).toLocaleTimeString()}] `),e&&this.traceOutputChannel.appendLine(`${JSON.stringify(e)}`)}needsStart(){return this.state===_.Initial||this.state===_.Stopping||this.state===_.Stopped}needsStop(){return this.state===_.Starting||this.state===_.Running}onReady(){return this._onReady}isConnectionActive(){return this.state===_.Running&&!!this._resolvedConnection}start(){return this._onReadyCallbacks.isUsed&&(this._onReady=new Promise(((e,t)=>{this._onReadyCallbacks=new re(e,t)}))),this._listeners=[],this._providers=[],this._diagnostics||(this._diagnostics=this._clientOptions.diagnosticCollectionName?t.languages.createDiagnosticCollection(this._clientOptions.diagnosticCollectionName):t.languages.createDiagnosticCollection()),this.state=_.Starting,this.resolveConnection().then((e=>(e.onLogMessage((e=>{switch(e.type){case i.MessageType.Error:this.error(e.message,void 0,!1);break;case i.MessageType.Warning:this.warn(e.message,void 0,!1);break;case i.MessageType.Info:this.info(e.message,void 0,!1);break;default:this.outputChannel.appendLine(e.message)}})),e.onShowMessage((e=>{switch(e.type){case i.MessageType.Error:t.window.showErrorMessage(e.message);break;case i.MessageType.Warning:t.window.showWarningMessage(e.message);break;case i.MessageType.Info:t.window.showInformationMessage(e.message);break;default:t.window.showInformationMessage(e.message)}})),e.onRequest(i.ShowMessageRequest.type,(e=>{let n;switch(e.type){case i.MessageType.Error:n=t.window.showErrorMessage;break;case i.MessageType.Warning:n=t.window.showWarningMessage;break;case i.MessageType.Info:n=t.window.showInformationMessage;break;default:n=t.window.showInformationMessage}let o=e.actions||[];return n(e.message,...o)})),e.onTelemetry((e=>{this._telemetryEmitter.fire(e)})),e.onRequest(i.ShowDocumentRequest.type,(async e=>{var i;const n=async e=>{const i=this.protocol2CodeConverter.asUri(e.uri);try{if(!0===e.external){return{success:await t.env.openExternal(i)}}{const n={};return void 0!==e.selection&&(n.selection=this.protocol2CodeConverter.asRange(e.selection)),void 0===e.takeFocus||!1===e.takeFocus?n.preserveFocus=!0:!0===e.takeFocus&&(n.preserveFocus=!1),await t.window.showTextDocument(i,n),{success:!0}}}catch(n){return{success:!0}}},o=null===(i=this._clientOptions.middleware.window)||void 0===i?void 0:i.showDocument;return void 0!==o?o(e,n):n(e)})),e.listen(),this.initialize(e)))).then(void 0,(e=>{this.state=_.StartFailed,this._onReadyCallbacks.reject(e),this.error("Starting client failed",e),t.window.showErrorMessage(`Couldn't start client ${this._name}`)})),new t.Disposable((()=>{this.needsStop()&&this.stop()}))}resolveConnection(){return this._connectionPromise||(this._connectionPromise=this.createConnection()),this._connectionPromise}initialize(e){this.refreshTrace(e,!1);let n=this._clientOptions.initializationOptions,o=this._clientOptions.workspaceFolder?this._clientOptions.workspaceFolder.uri.fsPath:this._clientGetRootPath(),r={processId:null,clientInfo:{name:t.env.appName,version:t.version},locale:this.getLocale(),rootPath:o||null,rootUri:o?this._c2p.asUri(t.Uri.file(o)):null,capabilities:this.computeClientCapabilities(),initializationOptions:s.func(n)?n():n,trace:i.Trace.toString(this._trace),workspaceFolders:null};if(this.fillInitializeParams(r),this._clientOptions.progressOnInitialization){const t=l.generateUuid(),i=new d.ProgressPart(e,t);return r.workDoneToken=t,this.doInitialize(e,r).then((e=>(i.done(),e)),(e=>{throw i.cancel(),e}))}return this.doInitialize(e,r)}doInitialize(e,n){return e.initialize(n).then((t=>{let n;return this._resolvedConnection=e,this._initializeResult=t,this.state=_.Running,s.number(t.capabilities.textDocumentSync)?n=t.capabilities.textDocumentSync===i.TextDocumentSyncKind.None?{openClose:!1,change:i.TextDocumentSyncKind.None,save:void 0}:{openClose:!0,change:t.capabilities.textDocumentSync,save:{includeText:!1}}:void 0!==t.capabilities.textDocumentSync&&null!==t.capabilities.textDocumentSync&&(n=t.capabilities.textDocumentSync),this._capabilities=Object.assign({},t.capabilities,{resolvedTextDocumentSync:n}),e.onDiagnostics((e=>this.handleDiagnostics(e))),e.onRequest(i.RegistrationRequest.type,(e=>this.handleRegistrationRequest(e))),e.onRequest("client/registerFeature",(e=>this.handleRegistrationRequest(e))),e.onRequest(i.UnregistrationRequest.type,(e=>this.handleUnregistrationRequest(e))),e.onRequest("client/unregisterFeature",(e=>this.handleUnregistrationRequest(e))),e.onRequest(i.ApplyWorkspaceEditRequest.type,(e=>this.handleApplyWorkspaceEdit(e))),e.sendNotification(i.InitializedNotification.type,{}),this.hookFileEvents(e),this.hookConfigurationChanged(e),this.initializeFeatures(e),this._onReadyCallbacks.resolve(),t})).then(void 0,(n=>{throw this._clientOptions.initializationFailedHandler?this._clientOptions.initializationFailedHandler(n)?this.initialize(e):(this.stop(),this._onReadyCallbacks.reject(n)):n instanceof i.ResponseError&&n.data&&n.data.retry?t.window.showErrorMessage(n.message,{title:"Retry",id:"retry"}).then((t=>{t&&"retry"===t.id?this.initialize(e):(this.stop(),this._onReadyCallbacks.reject(n))})):(n&&n.message&&t.window.showErrorMessage(n.message),this.error("Server initialization failed.",n),this.stop(),this._onReadyCallbacks.reject(n)),n}))}_clientGetRootPath(){let e=t.workspace.workspaceFolders;if(!e||0===e.length)return;let i=e[0];return"file"===i.uri.scheme?i.uri.fsPath:void 0}stop(){return this._initializeResult=void 0,this._connectionPromise?this.state===_.Stopping&&this._onStop?this._onStop:(this.state=_.Stopping,this.cleanUp(!1),this._onStop=this.resolveConnection().then((e=>e.shutdown().then((()=>{e.exit(),e.end(),e.dispose(),this.state=_.Stopped,this.cleanUpChannel(),this._onStop=void 0,this._connectionPromise=void 0,this._resolvedConnection=void 0}))))):(this.state=_.Stopped,Promise.resolve())}cleanUp(e=!0,t=!0){this._listeners&&(this._listeners.forEach((e=>e.dispose())),this._listeners=void 0),this._providers&&(this._providers.forEach((e=>e.dispose())),this._providers=void 0),this._syncedDocuments&&this._syncedDocuments.clear();for(const i of this._features.values())i.dispose();e&&this.cleanUpChannel(),t&&this._diagnostics&&(this._diagnostics.dispose(),this._diagnostics=void 0)}cleanUpChannel(){this._outputChannel&&this._disposeOutputChannel&&(this._outputChannel.dispose(),this._outputChannel=void 0)}notifyFileEvent(e){var t;const i=this;function n(e){i._fileEvents.push(e),i._fileEventDelayer.trigger((()=>{i.onReady().then((()=>{i.resolveConnection().then((e=>{i.isConnectionActive()&&(i.forceDocumentSync(),e.didChangeWatchedFiles({changes:i._fileEvents})),i._fileEvents=[]}))}),(e=>{i.error("Notify file events failed.",e)}))}))}const o=null===(t=this.clientOptions.middleware)||void 0===t?void 0:t.workspace;(null==o?void 0:o.didChangeWatchedFile)?o.didChangeWatchedFile(e,n):n(e)}forceDocumentSync(){void 0===this._didChangeTextDocumentFeature&&(this._didChangeTextDocumentFeature=this._dynamicFeatures.get(i.DidChangeTextDocumentNotification.type.method)),this._didChangeTextDocumentFeature.forceDelivery()}handleDiagnostics(e){if(!this._diagnostics)return;let t=this._p2c.asUri(e.uri),i=this._p2c.asDiagnostics(e.diagnostics),n=this.clientOptions.middleware;n.handleDiagnostics?n.handleDiagnostics(t,i,((e,t)=>this.setDiagnostics(e,t))):this.setDiagnostics(t,i)}setDiagnostics(e,t){this._diagnostics&&this._diagnostics.set(e,t)}createConnection(){let e=(e,t,i)=>{this.handleConnectionError(e,t,i)},t=()=>{this.handleConnectionClosed()};return this.createMessageTransports(this._clientOptions.stdioEncoding||"utf8").then((n=>function(e,t,n,o,r){let a=new u,c=i.createProtocolConnection(e,t,a,r);return c.onError((e=>{n(e[0],e[1],e[2])})),c.onClose(o),{listen:()=>c.listen(),sendRequest:(e,...t)=>c.sendRequest(s.string(e)?e:e.method,...t),onRequest:(e,t)=>c.onRequest(s.string(e)?e:e.method,t),sendNotification:(e,t)=>c.sendNotification(s.string(e)?e:e.method,t),onNotification:(e,t)=>c.onNotification(s.string(e)?e:e.method,t),onProgress:c.onProgress,sendProgress:c.sendProgress,trace:(e,t,n)=>{const o={sendNotification:!1,traceFormat:i.TraceFormat.Text};void 0===n?c.trace(e,t,o):(s.boolean(n),c.trace(e,t,n))},initialize:e=>c.sendRequest(i.InitializeRequest.type,e),shutdown:()=>c.sendRequest(i.ShutdownRequest.type,void 0),exit:()=>c.sendNotification(i.ExitNotification.type),onLogMessage:e=>c.onNotification(i.LogMessageNotification.type,e),onShowMessage:e=>c.onNotification(i.ShowMessageNotification.type,e),onTelemetry:e=>c.onNotification(i.TelemetryEventNotification.type,e),didChangeConfiguration:e=>c.sendNotification(i.DidChangeConfigurationNotification.type,e),didChangeWatchedFiles:e=>c.sendNotification(i.DidChangeWatchedFilesNotification.type,e),didOpenTextDocument:e=>c.sendNotification(i.DidOpenTextDocumentNotification.type,e),didChangeTextDocument:e=>c.sendNotification(i.DidChangeTextDocumentNotification.type,e),didCloseTextDocument:e=>c.sendNotification(i.DidCloseTextDocumentNotification.type,e),didSaveTextDocument:e=>c.sendNotification(i.DidSaveTextDocumentNotification.type,e),onDiagnostics:e=>c.onNotification(i.PublishDiagnosticsNotification.type,e),end:()=>c.end(),dispose:()=>c.dispose()}}(n.reader,n.writer,e,t,this._clientOptions.connectionOptions)))}handleConnectionClosed(){if(this.state===_.Stopping||this.state===_.Stopped)return;try{this._resolvedConnection&&this._resolvedConnection.dispose()}catch(t){}let e=p.DoNotRestart;try{e=this._clientOptions.errorHandler.closed()}catch(t){}this._connectionPromise=void 0,this._resolvedConnection=void 0,e===p.DoNotRestart?(this.error("Connection to server got closed. Server will not be restarted."),this.state===_.Starting?(this._onReadyCallbacks.reject(new Error("Connection to server got closed. Server will not be restarted.")),this.state=_.StartFailed):this.state=_.Stopped,this.cleanUp(!1,!0)):e===p.Restart&&(this.info("Connection to server got closed. Server will restart."),this.cleanUp(!1,!1),this.state=_.Initial,this.start())}handleConnectionError(e,t,i){this._clientOptions.errorHandler.error(e,t,i)===g.Shutdown&&(this.error("Connection to server is erroring. Shutting down server."),this.stop())}hookConfigurationChanged(e){t.workspace.onDidChangeConfiguration((()=>{this.refreshTrace(e,!0)}))}refreshTrace(e,n=!1){let o=t.workspace.getConfiguration(this._id),r=i.Trace.Off,s=i.TraceFormat.Text;if(o){const e=o.get("trace.server","off");"string"==typeof e?r=i.Trace.fromString(e):(r=i.Trace.fromString(o.get("trace.server.verbosity","off")),s=i.TraceFormat.fromString(o.get("trace.server.format","text")))}this._trace=r,this._traceFormat=s,e.trace(this._trace,this._tracer,{sendNotification:n,traceFormat:this._traceFormat})}hookFileEvents(e){let t,n=this._clientOptions.synchronize.fileEvents;n&&(t=s.array(n)?n:[n],t&&this._dynamicFeatures.get(i.DidChangeWatchedFilesNotification.type.method).registerRaw(l.generateUuid(),t))}registerFeatures(e){for(let t of e)this.registerFeature(t)}registerFeature(e){if(this._features.push(e),k.is(e)){const t=e.registrationType;this._dynamicFeatures.set(t.method,e)}}getFeature(e){return this._dynamicFeatures.get(e)}registerBuiltinFeatures(){this.registerFeature(new te(this)),this.registerFeature(new F(this,this._syncedDocuments)),this.registerFeature(new I(this)),this.registerFeature(new M(this)),this.registerFeature(new q(this)),this.registerFeature(new L(this)),this.registerFeature(new E(this,this._syncedDocuments)),this.registerFeature(new H(this,(e=>this.notifyFileEvent(e)))),this.registerFeature(new A(this)),this.registerFeature(new N(this)),this.registerFeature(new W(this)),this.registerFeature(new U(this)),this.registerFeature(new z(this)),this.registerFeature(new j(this)),this.registerFeature(new $(this)),this.registerFeature(new B(this)),this.registerFeature(new V(this)),this.registerFeature(new G(this)),this.registerFeature(new J(this)),this.registerFeature(new Q(this)),this.registerFeature(new X(this)),this.registerFeature(new Y(this)),this.registerFeature(new ee(this)),this.registerFeature(new oe(this))}fillInitializeParams(e){for(let t of this._features)s.func(t.fillInitializeParams)&&t.fillInitializeParams(e)}computeClientCapabilities(){const e={};P(e,"workspace").applyEdit=!0;const t=P(P(e,"workspace"),"workspaceEdit");t.documentChanges=!0,t.resourceOperations=[i.ResourceOperationKind.Create,i.ResourceOperationKind.Rename,i.ResourceOperationKind.Delete],t.failureHandling=i.FailureHandlingKind.TextOnlyTransactional,t.normalizesLineEndings=!0,t.changeAnnotationSupport={groupsOnLabel:!0};const n=P(P(e,"textDocument"),"publishDiagnostics");n.relatedInformation=!0,n.versionSupport=!1,n.tagSupport={valueSet:[i.DiagnosticTag.Unnecessary,i.DiagnosticTag.Deprecated]},n.codeDescriptionSupport=!0,n.dataSupport=!0;const o=P(e,"window");P(o,"showMessage").messageActionItem={additionalPropertiesSupport:!0};P(o,"showDocument").support=!0;const r=P(e,"general");r.regularExpressions={engine:"ECMAScript",version:"ES2020"},r.markdown={parser:"marked",version:"1.1.0"};for(let i of this._features)i.fillClientCapabilities(e);return e}initializeFeatures(e){let t=this._clientOptions.documentSelector;for(let i of this._features)i.initialize(this._capabilities,t)}handleRegistrationRequest(e){return new Promise(((t,i)=>{for(const o of e.registrations){const e=this._dynamicFeatures.get(o.method);if(void 0===e)return void i(new Error(`No feature implementation for ${o.method} found. Registration failed.`));const t=o.registerOptions||{};t.documentSelector=t.documentSelector||this._clientOptions.documentSelector;const r={id:o.id,registerOptions:t};try{e.register(r)}catch(n){return void i(n)}}t()}))}handleUnregistrationRequest(e){return new Promise(((t,i)=>{for(let n of e.unregisterations){const e=this._dynamicFeatures.get(n.method);if(!e)return void i(new Error(`No feature implementation for ${n.method} found. Unregistration failed.`));e.unregister(n.id)}t()}))}handleApplyWorkspaceEdit(e){let n=e.edit,o=new Map;t.workspace.textDocuments.forEach((e=>o.set(e.uri.toString(),e)));let r=!1;if(n.documentChanges)for(const t of n.documentChanges)if(i.TextDocumentEdit.is(t)&&t.textDocument.version&&t.textDocument.version>=0){let e=o.get(t.textDocument.uri);if(e&&e.version!==t.textDocument.version){r=!0;break}}return r?Promise.resolve({applied:!1}):s.asPromise(t.workspace.applyEdit(this._p2c.asWorkspaceEdit(e.edit)).then((e=>({applied:e}))))}handleFailedRequest(e,t,n){if(t instanceof i.ResponseError){if(t.code===i.LSPErrorCodes.RequestCancelled)throw this.makeCancelError();if(t.code===i.LSPErrorCodes.ContentModified)return n}throw this.error(`Request ${e.method} failed.`,t),t}makeCancelError(){const e=new Error(se.Canceled);return e.name=se.Canceled,e}}e.BaseLanguageClient=se,se.Canceled="Canceled"}(Q);var rt={};Object.defineProperty(rt,"__esModule",{value:!0});var st=rt.TypeDefinitionFeature=void 0;const at=C,ct=a,lt=Q;function dt(e,t){return void 0===e[t]&&(e[t]={}),e[t]}st=rt.TypeDefinitionFeature=class extends lt.TextDocumentFeature{constructor(e){super(e,ct.TypeDefinitionRequest.type)}fillClientCapabilities(e){dt(dt(e,"textDocument"),"typeDefinition").dynamicRegistration=!0;let t=dt(dt(e,"textDocument"),"typeDefinition");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){let[i,n]=this.getRegistration(t,e.typeDefinitionProvider);i&&n&&this.register({id:i,registerOptions:n})}registerLanguageProvider(e){const t={provideTypeDefinition:(e,t,i)=>{const n=this._client,o=(e,t,i)=>n.sendRequest(ct.TypeDefinitionRequest.type,n.code2ProtocolConverter.asTextDocumentPositionParams(e,t),i).then(n.protocol2CodeConverter.asDefinitionResult,(e=>n.handleFailedRequest(ct.TypeDefinitionRequest.type,e,null))),r=n.clientOptions.middleware;return r.provideTypeDefinition?r.provideTypeDefinition(e,t,i,o):o(e,t,i)}};return[at.languages.registerTypeDefinitionProvider(e.documentSelector,t),t]}};var ut={};Object.defineProperty(ut,"__esModule",{value:!0});var gt=ut.ImplementationFeature=void 0;const ht=C,pt=a,mt=Q;function ft(e,t){return void 0===e[t]&&(e[t]={}),e[t]}gt=ut.ImplementationFeature=class extends mt.TextDocumentFeature{constructor(e){super(e,pt.ImplementationRequest.type)}fillClientCapabilities(e){let t=ft(ft(e,"textDocument"),"implementation");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){let[i,n]=this.getRegistration(t,e.implementationProvider);i&&n&&this.register({id:i,registerOptions:n})}registerLanguageProvider(e){const t={provideImplementation:(e,t,i)=>{const n=this._client,o=(e,t,i)=>n.sendRequest(pt.ImplementationRequest.type,n.code2ProtocolConverter.asTextDocumentPositionParams(e,t),i).then(n.protocol2CodeConverter.asDefinitionResult,(e=>n.handleFailedRequest(pt.ImplementationRequest.type,e,null))),r=n.clientOptions.middleware;return r.provideImplementation?r.provideImplementation(e,t,i,o):o(e,t,i)}};return[ht.languages.registerImplementationProvider(e.documentSelector,t),t]}};var vt={};Object.defineProperty(vt,"__esModule",{value:!0});var Ct=vt.ColorProviderFeature=void 0;const yt=C,Dt=a,_t=Q;function St(e,t){return void 0===e[t]&&(e[t]={}),e[t]}Ct=vt.ColorProviderFeature=class extends _t.TextDocumentFeature{constructor(e){super(e,Dt.DocumentColorRequest.type)}fillClientCapabilities(e){St(St(e,"textDocument"),"colorProvider").dynamicRegistration=!0}initialize(e,t){let[i,n]=this.getRegistration(t,e.colorProvider);i&&n&&this.register({id:i,registerOptions:n})}registerLanguageProvider(e){const t={provideColorPresentations:(e,t,i)=>{const n=this._client,o=(e,t,i)=>{const o={color:e,textDocument:n.code2ProtocolConverter.asTextDocumentIdentifier(t.document),range:n.code2ProtocolConverter.asRange(t.range)};return n.sendRequest(Dt.ColorPresentationRequest.type,o,i).then(this.asColorPresentations.bind(this),(e=>n.handleFailedRequest(Dt.ColorPresentationRequest.type,e,null)))},r=n.clientOptions.middleware;return r.provideColorPresentations?r.provideColorPresentations(e,t,i,o):o(e,t,i)},provideDocumentColors:(e,t)=>{const i=this._client,n=(e,t)=>{const n={textDocument:i.code2ProtocolConverter.asTextDocumentIdentifier(e)};return i.sendRequest(Dt.DocumentColorRequest.type,n,t).then(this.asColorInformations.bind(this),(e=>i.handleFailedRequest(Dt.ColorPresentationRequest.type,e,null)))},o=i.clientOptions.middleware;return o.provideDocumentColors?o.provideDocumentColors(e,t,n):n(e,t)}};return[yt.languages.registerColorProvider(e.documentSelector,t),t]}asColor(e){return new yt.Color(e.red,e.green,e.blue,e.alpha)}asColorInformations(e){return Array.isArray(e)?e.map((e=>new yt.ColorInformation(this._client.protocol2CodeConverter.asRange(e.range),this.asColor(e.color)))):[]}asColorPresentations(e){return Array.isArray(e)?e.map((e=>{let t=new yt.ColorPresentation(e.label);return t.additionalTextEdits=this._client.protocol2CodeConverter.asTextEdits(e.additionalTextEdits),t.textEdit=this._client.protocol2CodeConverter.asTextEdit(e.textEdit),t})):[]}};var Rt={};Object.defineProperty(Rt,"__esModule",{value:!0});var wt=Rt.WorkspaceFoldersFeature=Rt.arrayDiff=void 0;const Tt=Je,xt=C,Pt=a;function bt(e,t){if(void 0!==e)return e[t]}function kt(e,t){return e.filter((e=>t.indexOf(e)<0))}Rt.arrayDiff=kt;wt=Rt.WorkspaceFoldersFeature=class{constructor(e){this._client=e,this._listeners=new Map}get registrationType(){return Pt.DidChangeWorkspaceFoldersNotification.type}fillInitializeParams(e){const t=xt.workspace.workspaceFolders;this.initializeWithFolders(t),e.workspaceFolders=void 0===t?null:t.map((e=>this.asProtocol(e)))}initializeWithFolders(e){this._initialFolders=e}fillClientCapabilities(e){e.workspace=e.workspace||{},e.workspace.workspaceFolders=!0}initialize(e){const t=this._client;t.onRequest(Pt.WorkspaceFoldersRequest.type,(e=>{const i=()=>{const e=xt.workspace.workspaceFolders;if(void 0===e)return null;return e.map((e=>this.asProtocol(e)))},n=t.clientOptions.middleware.workspace;return n&&n.workspaceFolders?n.workspaceFolders(e,i):i()}));const i=bt(bt(bt(e,"workspace"),"workspaceFolders"),"changeNotifications");let n;"string"==typeof i?n=i:!0===i&&(n=Tt.generateUuid()),n&&this.register({id:n,registerOptions:void 0})}sendInitialEvent(e){if(this._initialFolders&&e){const t=kt(this._initialFolders,e),i=kt(e,this._initialFolders);(i.length>0||t.length>0)&&this.doSendEvent(i,t)}else this._initialFolders?this.doSendEvent([],this._initialFolders):e&&this.doSendEvent(e,[])}doSendEvent(e,t){let i={event:{added:e.map((e=>this.asProtocol(e))),removed:t.map((e=>this.asProtocol(e)))}};this._client.sendNotification(Pt.DidChangeWorkspaceFoldersNotification.type,i)}register(e){let t=e.id,i=this._client,n=xt.workspace.onDidChangeWorkspaceFolders((e=>{let t=e=>{this.doSendEvent(e.added,e.removed)},n=i.clientOptions.middleware.workspace;n&&n.didChangeWorkspaceFolders?n.didChangeWorkspaceFolders(e,t):t(e)}));this._listeners.set(t,n),this.sendInitialEvent(xt.workspace.workspaceFolders)}unregister(e){let t=this._listeners.get(e);void 0!==t&&(this._listeners.delete(e),t.dispose())}dispose(){for(let e of this._listeners.values())e.dispose();this._listeners.clear()}asProtocol(e){return void 0===e?null:{uri:this._client.code2ProtocolConverter.asUri(e.uri),name:e.name}}};var Ot={};Object.defineProperty(Ot,"__esModule",{value:!0});var Ft=Ot.FoldingRangeFeature=void 0;const Et=C,It=a,Mt=Q;function qt(e,t){return void 0===e[t]&&(e[t]={}),e[t]}class Lt extends Mt.TextDocumentFeature{constructor(e){super(e,It.FoldingRangeRequest.type)}fillClientCapabilities(e){let t=qt(qt(e,"textDocument"),"foldingRange");t.dynamicRegistration=!0,t.rangeLimit=5e3,t.lineFoldingOnly=!0}initialize(e,t){let[i,n]=this.getRegistration(t,e.foldingRangeProvider);i&&n&&this.register({id:i,registerOptions:n})}registerLanguageProvider(e){const t={provideFoldingRanges:(e,t,i)=>{const n=this._client,o=(e,t,i)=>{const o={textDocument:n.code2ProtocolConverter.asTextDocumentIdentifier(e)};return n.sendRequest(It.FoldingRangeRequest.type,o,i).then(Lt.asFoldingRanges,(e=>n.handleFailedRequest(It.FoldingRangeRequest.type,e,null)))},r=n.clientOptions.middleware;return r.provideFoldingRanges?r.provideFoldingRanges(e,t,i,o):o(e,0,i)}};return[Et.languages.registerFoldingRangeProvider(e.documentSelector,t),t]}static asFoldingRangeKind(e){if(e)switch(e){case It.FoldingRangeKind.Comment:return Et.FoldingRangeKind.Comment;case It.FoldingRangeKind.Imports:return Et.FoldingRangeKind.Imports;case It.FoldingRangeKind.Region:return Et.FoldingRangeKind.Region}}static asFoldingRanges(e){return Array.isArray(e)?e.map((e=>new Et.FoldingRange(e.startLine,e.endLine,Lt.asFoldingRangeKind(e.kind)))):[]}}Ft=Ot.FoldingRangeFeature=Lt;var Ht={};Object.defineProperty(Ht,"__esModule",{value:!0});var Kt=Ht.CallHierarchyFeature=void 0;const At=C,Nt=a,Wt=Q;function Ut(e,t){return void 0===e[t]&&(e[t]={}),e[t]}class zt{constructor(e){this.client=e,this.middleware=e.clientOptions.middleware}prepareCallHierarchy(e,t,i){const n=this.client,o=this.middleware,r=(e,t,i)=>{const o=n.code2ProtocolConverter.asTextDocumentPositionParams(e,t);return n.sendRequest(Nt.CallHierarchyPrepareRequest.type,o,i).then((e=>n.protocol2CodeConverter.asCallHierarchyItems(e)),(e=>n.handleFailedRequest(Nt.CallHierarchyPrepareRequest.type,e,null)))};return o.prepareCallHierarchy?o.prepareCallHierarchy(e,t,i,r):r(e,t,i)}provideCallHierarchyIncomingCalls(e,t){const i=this.client,n=this.middleware,o=(e,t)=>{const n={item:i.code2ProtocolConverter.asCallHierarchyItem(e)};return i.sendRequest(Nt.CallHierarchyIncomingCallsRequest.type,n,t).then((e=>i.protocol2CodeConverter.asCallHierarchyIncomingCalls(e)),(e=>i.handleFailedRequest(Nt.CallHierarchyIncomingCallsRequest.type,e,null)))};return n.provideCallHierarchyIncomingCalls?n.provideCallHierarchyIncomingCalls(e,t,o):o(e,t)}provideCallHierarchyOutgoingCalls(e,t){const i=this.client,n=this.middleware,o=(e,t)=>{const n={item:i.code2ProtocolConverter.asCallHierarchyItem(e)};return i.sendRequest(Nt.CallHierarchyOutgoingCallsRequest.type,n,t).then((e=>i.protocol2CodeConverter.asCallHierarchyOutgoingCalls(e)),(e=>i.handleFailedRequest(Nt.CallHierarchyOutgoingCallsRequest.type,e,null)))};return n.provideCallHierarchyOutgoingCalls?n.provideCallHierarchyOutgoingCalls(e,t,o):o(e,t)}}Kt=Ht.CallHierarchyFeature=class extends Wt.TextDocumentFeature{constructor(e){super(e,Nt.CallHierarchyPrepareRequest.type)}fillClientCapabilities(e){Ut(Ut(e,"textDocument"),"callHierarchy").dynamicRegistration=!0}initialize(e,t){const[i,n]=this.getRegistration(t,e.callHierarchyProvider);i&&n&&this.register({id:i,registerOptions:n})}registerLanguageProvider(e){const t=this._client,i=new zt(t);return[At.languages.registerCallHierarchyProvider(e.documentSelector,i),i]}};var jt={};Object.defineProperty(jt,"__esModule",{value:!0});var $t=jt.SemanticTokensFeature=void 0;const Bt=C,Vt=Q,Gt=a,Jt=ne;function Qt(e,t){return void 0===e[t]&&(e[t]={}),e[t]}$t=jt.SemanticTokensFeature=class extends Vt.TextDocumentFeature{constructor(e){super(e,Gt.SemanticTokensRegistrationType.type)}fillClientCapabilities(e){const t=Qt(Qt(e,"textDocument"),"semanticTokens");t.dynamicRegistration=!0,t.tokenTypes=[Gt.SemanticTokenTypes.namespace,Gt.SemanticTokenTypes.type,Gt.SemanticTokenTypes.class,Gt.SemanticTokenTypes.enum,Gt.SemanticTokenTypes.interface,Gt.SemanticTokenTypes.struct,Gt.SemanticTokenTypes.typeParameter,Gt.SemanticTokenTypes.parameter,Gt.SemanticTokenTypes.variable,Gt.SemanticTokenTypes.property,Gt.SemanticTokenTypes.enumMember,Gt.SemanticTokenTypes.event,Gt.SemanticTokenTypes.function,Gt.SemanticTokenTypes.method,Gt.SemanticTokenTypes.macro,Gt.SemanticTokenTypes.keyword,Gt.SemanticTokenTypes.modifier,Gt.SemanticTokenTypes.comment,Gt.SemanticTokenTypes.string,Gt.SemanticTokenTypes.number,Gt.SemanticTokenTypes.regexp,Gt.SemanticTokenTypes.operator],t.tokenModifiers=[Gt.SemanticTokenModifiers.declaration,Gt.SemanticTokenModifiers.definition,Gt.SemanticTokenModifiers.readonly,Gt.SemanticTokenModifiers.static,Gt.SemanticTokenModifiers.deprecated,Gt.SemanticTokenModifiers.abstract,Gt.SemanticTokenModifiers.async,Gt.SemanticTokenModifiers.modification,Gt.SemanticTokenModifiers.documentation,Gt.SemanticTokenModifiers.defaultLibrary],t.formats=[Gt.TokenFormat.Relative],t.requests={range:!0,full:{delta:!0}},t.multilineTokenSupport=!1,t.overlappingTokenSupport=!1,Qt(Qt(e,"workspace"),"semanticTokens").refreshSupport=!0}initialize(e,t){this._client.onRequest(Gt.SemanticTokensRefreshRequest.type,(async()=>{for(const e of this.getAllProviders())e.onDidChangeSemanticTokensEmitter.fire()}));const[i,n]=this.getRegistration(t,e.semanticTokensProvider);i&&n&&this.register({id:i,registerOptions:n})}registerLanguageProvider(e){const t=Jt.boolean(e.full)?e.full:void 0!==e.full,i=void 0!==e.full&&"boolean"!=typeof e.full&&!0===e.full.delta,n=new Bt.EventEmitter,o=t?{onDidChangeSemanticTokens:n.event,provideDocumentSemanticTokens:(e,t)=>{const i=this._client,n=i.clientOptions.middleware,o=(e,t)=>{const n={textDocument:i.code2ProtocolConverter.asTextDocumentIdentifier(e)};return i.sendRequest(Gt.SemanticTokensRequest.type,n,t).then((e=>i.protocol2CodeConverter.asSemanticTokens(e)),(e=>i.handleFailedRequest(Gt.SemanticTokensRequest.type,e,null)))};return n.provideDocumentSemanticTokens?n.provideDocumentSemanticTokens(e,t,o):o(e,t)},provideDocumentSemanticTokensEdits:i?(e,t,i)=>{const n=this._client,o=n.clientOptions.middleware,r=(e,t,i)=>{const o={textDocument:n.code2ProtocolConverter.asTextDocumentIdentifier(e),previousResultId:t};return n.sendRequest(Gt.SemanticTokensDeltaRequest.type,o,i).then((e=>Gt.SemanticTokens.is(e)?n.protocol2CodeConverter.asSemanticTokens(e):n.protocol2CodeConverter.asSemanticTokensEdits(e)),(e=>n.handleFailedRequest(Gt.SemanticTokensDeltaRequest.type,e,null)))};return o.provideDocumentSemanticTokensEdits?o.provideDocumentSemanticTokensEdits(e,t,i,r):r(e,t,i)}:void 0}:void 0,r=!0===e.range?{provideDocumentRangeSemanticTokens:(e,t,i)=>{const n=this._client,o=n.clientOptions.middleware,r=(e,t,i)=>{const o={textDocument:n.code2ProtocolConverter.asTextDocumentIdentifier(e),range:n.code2ProtocolConverter.asRange(t)};return n.sendRequest(Gt.SemanticTokensRangeRequest.type,o,i).then((e=>n.protocol2CodeConverter.asSemanticTokens(e)),(e=>n.handleFailedRequest(Gt.SemanticTokensRangeRequest.type,e,null)))};return o.provideDocumentRangeSemanticTokens?o.provideDocumentRangeSemanticTokens(e,t,i,r):r(e,t,i)}}:void 0,s=[],a=this._client.protocol2CodeConverter.asSemanticTokensLegend(e.legend);return void 0!==o&&s.push(Bt.languages.registerDocumentSemanticTokensProvider(e.documentSelector,o,a)),void 0!==r&&s.push(Bt.languages.registerDocumentRangeSemanticTokensProvider(e.documentSelector,r,a)),[new Bt.Disposable((()=>s.forEach((e=>e.dispose())))),{range:r,full:o,onDidChangeSemanticTokensEmitter:n}]}};var Zt={};Object.defineProperty(Zt,"__esModule",{value:!0});var Xt=Zt.DeclarationFeature=void 0;const Yt=C,ei=a,ti=Q;function ii(e,t){return void 0===e[t]&&(e[t]={}),e[t]}Xt=Zt.DeclarationFeature=class extends ti.TextDocumentFeature{constructor(e){super(e,ei.DeclarationRequest.type)}fillClientCapabilities(e){const t=ii(ii(e,"textDocument"),"declaration");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){const[i,n]=this.getRegistration(t,e.declarationProvider);i&&n&&this.register({id:i,registerOptions:n})}registerLanguageProvider(e){const t={provideDeclaration:(e,t,i)=>{const n=this._client,o=(e,t,i)=>n.sendRequest(ei.DeclarationRequest.type,n.code2ProtocolConverter.asTextDocumentPositionParams(e,t),i).then(n.protocol2CodeConverter.asDeclarationResult,(e=>n.handleFailedRequest(ei.DeclarationRequest.type,e,null))),r=n.clientOptions.middleware;return r.provideDeclaration?r.provideDeclaration(e,t,i,o):o(e,t,i)}};return[Yt.languages.registerDeclarationProvider(e.documentSelector,t),t]}};const ni=class extends Q.BaseLanguageClient{constructor({id:e,name:t,clientOptions:i,connectionProvider:n}){super(e||t.toLowerCase(),t,i),this.connectionProvider=n,this.createConnection=this.doCreateConnection.bind(this);const o=this;o._p2c=new Proxy(o._p2c,{get:(e,t)=>"asUri"===t?e[t]:ni.bypassConversion}),o._c2p=new Proxy(o._c2p,{get:(e,t)=>"asUri"===t?e[t]:"asCompletionParams"===t?(t,i,n)=>({textDocument:e.asTextDocumentIdentifier(t),position:i,context:n}):"asWillSaveTextDocumentParams"===t?t=>({textDocument:e.asTextDocumentIdentifier(t.document),reason:t.reason}):t.endsWith("Params")?e[t]:ni.bypassConversion})}doCreateConnection(){const e=this.handleConnectionError.bind(this),t=this.handleConnectionClosed.bind(this);return this.connectionProvider.get(e,t,this.outputChannel)}createMessageTransports(e){throw new Error("Unsupported")}registerBuiltinFeatures(){super.registerBuiltinFeatures(),this.registerFeature(new ee(this)),this.registerFeature(new st(this)),this.registerFeature(new gt(this)),this.registerFeature(new Ct(this)),this.registerFeature(new wt(this)),Ft.asFoldingRanges=ni.bypassConversion,this.registerFeature(new Ft(this)),this.registerFeature(new Xt(this)),this.registerFeature(new $t(this)),this.registerFeature(new Kt(this));const e=this._features;for(const t of e)t instanceof Ct&&(t.asColor=ni.bypassConversion,t.asColorInformations=ni.bypassConversion,t.asColorPresentations=ni.bypassConversion)}registerProposedFeatures(){}getLocale(){return navigator.language||"en-US"}};let oi=ni;oi.bypassConversion=e=>e||void 0;class ri{constructor(e){this._monaco=e}registerCommand(e,t,i){return this._monaco.editor.registerCommand(e,((e,...n)=>t.call(i,...n)))}}class si{constructor(){this.channels=new Map}showMessage(e,t,...i){return e===a.MessageType.Error&&console.error(t),e===a.MessageType.Warning&&console.warn(t),e===a.MessageType.Info&&console.info(t),e===a.MessageType.Log&&console.log(t),Promise.resolve(void 0)}createOutputChannel(e){const t=this.channels.get(e);if(t)return t;const i={append(t){console.log(e+": "+t)},appendLine(t){console.log(e+": "+t)},show(){},dispose(){}};return this.channels.set(e,i),i}}class ai{constructor(e,t,i,n=null){this._monaco=e,this.p2m=t,this.m2p=i,this._rootUri=n,this.documents=new Map,this.onDidOpenTextDocumentEmitter=new o.Emitter,this.onDidCloseTextDocumentEmitter=new o.Emitter,this.onDidChangeTextDocumentEmitter=new o.Emitter;for(const o of this._monaco.editor.getModels())this.addModel(o);this._monaco.editor.onDidCreateModel((e=>this.addModel(e))),this._monaco.editor.onWillDisposeModel((e=>this.removeModel(e))),this._monaco.editor.onDidChangeModelLanguage((e=>{this.removeModel(e.model),this.addModel(e.model)}))}get rootUri(){return this._rootUri}removeModel(e){const t=e.uri.toString(),i=this.documents.get(t);i&&(this.documents.delete(t),this.onDidCloseTextDocumentEmitter.fire(i))}addModel(e){const t=e.uri.toString(),i=this.setModel(t,e);this.onDidOpenTextDocumentEmitter.fire(i),e.onDidChangeContent((i=>this.onDidChangeContent(t,e,i)))}onDidChangeContent(e,t,i){const n=this.setModel(e,t),o=[];for(const r of i.changes){const e=this.m2p.asRange(r.range),t=r.rangeLength,i=r.text;o.push({range:e,rangeLength:t,text:i})}this.onDidChangeTextDocumentEmitter.fire({textDocument:n,contentChanges:o})}setModel(e,t){const i=y.create(e,t.getLanguageId(),t.getVersionId(),t.getValue());return this.documents.set(e,i),i}get textDocuments(){return Array.from(this.documents.values())}get onDidOpenTextDocument(){return this.onDidOpenTextDocumentEmitter.event}get onDidCloseTextDocument(){return this.onDidCloseTextDocumentEmitter.event}get onDidChangeTextDocument(){return this.onDidChangeTextDocumentEmitter.event}applyEdit(e){const t=this.p2m.asWorkspaceEdit(e),i=t.edits?t.edits.reduce(((e,t)=>{const i=t;return e[i.resource.toString()]=this._monaco.editor.getModel(i.resource),e}),{}):{};if(!Object.keys(i).map((e=>i[e])).every((e=>!!e)))return Promise.resolve(!1);const n=t.edits?t.edits.reduce(((e,t)=>{const i=t,n=i.resource.toString();return n in e||(e[n]=[]),e[n].push({range:this._monaco.Range.lift(i.edit.range),text:i.edit.text}),e}),{}):{};return Object.keys(n).forEach((e=>{i[e].pushEditOperations([],n[e].map((e=>({identifier:{major:1,minor:0},range:e.range,text:e.text,forceMoveMarkers:!0}))),(()=>[]))})),Promise.resolve(!0)}}var ci;!function(e){function t(e,t={}){const i=new u(e),n=new g(e);return{commands:new ri(e),languages:new l(e,n,i),workspace:new ai(e,n,i,t.rootUri),window:new si}}e.create=t,e.install=function(e,i={}){const n=t(e,i);return p.install(n),n},e.get=function(){return p.get()}}(ci||(ci={}));let li;class di{constructor(){this._resolved=!1,this.resolve=[]}wait(){return this._wait}createNext(){return this._wait=new Promise((e=>{this.resolve.push(e)})),{next:e=>{this.resolve.length>0&&(this.resolve.forEach((t=>t(e))),this.resolve=[])}}}}class ui extends class{constructor(e){const t=new u(e),i=new g(e);this.m2p=t,this.p2m=i,this._onDispose=new e.Emitter,this.languages=new Proxy(new D(e,i,t),{get:(e,t,i)=>{if(/^register[A-Z]/.test(t)){const n=this;return function(){console.debug("[proxy] Monaco.languages",t);const o=Reflect.apply(e[t],i,arguments);if(o)return n.addDispose(o),o}}return e[t]}}),this._languages=new Proxy(e.languages,{get:(e,t,i)=>{if(/^register[A-Z]/.test(t)){const n=this;return function(){console.log("[proxy] Monaco.languages",t);const o=Reflect.apply(e[t],i,arguments);if(o)return n.addDispose(o),o}}return e[t]}})}addDispose(e){return this._onDispose.event(e.dispose)}dispose(){this._onDispose.fire(),this._onDispose.dispose()}}{constructor(e,t,i){super(e),this._monaco=e,this.service=t,this.languageId=i,this.attached=new Set,this.DiagnosticsTick=new di,this.updateModelMarkers=(e,t)=>{this._monaco.editor.setModelMarkers(e,this.languageId,this.p2m.asDiagnostics(t.diagnostics))},this.cancelToken=Symbol.for("lspCancelToken")}async initialize(e){this.initializeResult||(globalThis.setImmediate=(e,...t)=>globalThis.setTimeout(e,5,...t),this.initializeResult=await this.service.doInitialize(),this.addDocumentsHandler(),this.addCompletionHandler(),this.addFindReferencesHandler(),this.addDocumentSymbolHandler(),this.addGotoDefinitionHandler(),this.addDocumentHighlightsHandler(),this.addFoldingRangeHandler(),this.addCodeActionHandler(),this.addRenameHandler(),this.addHoverHandler())}addDocumentsHandler(){this.addDispose(this._monaco.editor.onDidCreateModel((e=>{const t=e.uri.toString(),{next:i}=this.DiagnosticsTick.createNext();this.service.doDocumentLoaded(t,e.getValue()).then((n=>{this.attached.has(t)&&this.updateModelMarkers(e,n),i(n)})),this.addDispose(e.onDidChangeAttached((()=>{this.attached.add(t),console.log("onDidChangeAttached",t)})));let n=-1;this.addDispose(e.onDidChangeContent((i=>{if(this.attached.has(t)){const{next:o}=this.DiagnosticsTick.createNext(),r=++n;this.service.doDidChangeContent(t,e.getValue(),i.changes).then((t=>{r===n&&(this.updateModelMarkers(e,t),n=-1,o(t))}))}})))})))}addCompletionHandler(){this.languages.registerCompletionItemProvider([this.languageId],{provideCompletionItems:this.bind(this.service.doProvideCompletionItems),resolveCompletionItem:async(e,t)=>await this.service.doResolveCompletionItem(e)},...this.initializeResult.capabilities.completionProvider.triggerCharacters||[]),this.languages.registerInlineCompletionItemProvider([this.languageId],{provideCompletionItems:this.bind(this.service.doProvideCompletionItems)})}addFindReferencesHandler(){this.languages.registerReferenceProvider([this.languageId],{provideReferences:this.bind(this.service.doFindReferences)})}addCodeActionHandler(){const e=this.initializeResult.capabilities.codeActionProvider;this.languages.registerCodeActionsProvider([this.languageId],{...e instanceof Object?e:{},provideCodeActions:this.bind(this.service.doProvideCodeActions)})}addDocumentSymbolHandler(){this.languages.registerDocumentSymbolProvider([this.languageId],{provideDocumentSymbols:this.bind(this.service.doProvideDocumentSymbols)});const{semanticTokensProvider:e}=this.initializeResult.capabilities;e&&(this.languages.registerDocumentSemanticTokensProvider([this.languageId],{provideDocumentSemanticTokens:this.bind(this.service.doDocumentSemanticTokens)},e.legend),this.languages.registerDocumentRangeSemanticTokensProvider([this.languageId],{provideDocumentRangeSemanticTokens:this.bind(this.service.doDocumentSemanticTokens)},e.legend))}addGotoDefinitionHandler(){this.languages.registerDefinitionProvider([this.languageId],{provideDefinition:this.bind(this.service.doProvideDefinition)}),this.languages.registerTypeDefinitionProvider([this.languageId],{provideTypeDefinition:this.bind(this.service.doProvideDefinition)})}addDocumentHighlightsHandler(){this.languages.registerDocumentHighlightProvider([this.languageId],{provideDocumentHighlights:this.bind(this.service.doProvideDocumentHighlights)})}addHoverHandler(){this.languages.registerHoverProvider([this.languageId],{provideHover:this.bind(this.service.doProvideHover)})}addFoldingRangeHandler(){this.languages.registerFoldingRangeProvider([this.languageId],{provideFoldingRanges:this.bind(this.service.doProvideFoldingRanges)})}addRenameHandler(){this.languages.registerRenameProvider([this.languageId],{provideRenameEdits:this.bind(this.service.doProvideRenameEdits),resolveRenameLocation:this.bind(this.service.doResolveRenameLocation)})}async wrapAsync(e,t){let i;try{const n=await Promise.race([e,new Promise((e=>{i=t.onCancellationRequested((()=>e(this.cancelToken)))}))]);if(n===this.cancelToken)return;return n}catch(n){i.dispose()}}bind(e){let t=0;return async(i,n)=>{if(a.TextDocumentIdentifier.is(i.textDocument)&&this.attached.has(i.textDocument.uri))try{if(await this.wrapAsync(this.DiagnosticsTick.wait(),n)){const n=++t,o=await e.apply(this.service,[i]);if(n===t)return t=0,o}}catch(o){throw console.error(o),o}else console.debug("Stop Event",i)}}}function gi(){function e(e){return new oi({name:"Sample Language Client",clientOptions:{documentSelector:["advscript"],errorHandler:{error:()=>c.ErrorAction.Continue,closed:()=>c.CloseAction.DoNotRestart}},connectionProvider:{get:(t,i)=>Promise.resolve(function(e,t,i){return e.onError((e=>{t(e[0],e[1],e[2])})),e.onClose(i),{listen:()=>e.listen(),sendRequest:(t,...i)=>e.sendRequest(s(t)?t:t.method,...i),onRequest:(t,i)=>e.onRequest(s(t)?t:t.method,i),sendNotification:(t,i)=>e.sendNotification(s(t)?t:t.method,i),onNotification:(t,i)=>e.onNotification(s(t)?t:t.method,i),trace:(t,i,n=!1)=>e.trace(t,i,n),initialize:t=>e.sendRequest(a.InitializeRequest.type,t),shutdown:()=>e.sendRequest(a.ShutdownRequest.type,void 0),exit:()=>e.sendNotification(a.ExitNotification.type),onLogMessage:t=>e.onNotification(a.LogMessageNotification.type,t),onShowMessage:t=>e.onNotification(a.ShowMessageNotification.type,t),onTelemetry:t=>e.onNotification(a.TelemetryEventNotification.type,t),didChangeConfiguration:t=>e.sendNotification(a.DidChangeConfigurationNotification.type,t),didChangeWatchedFiles:t=>e.sendNotification(a.DidChangeWatchedFilesNotification.type,t),didOpenTextDocument:t=>e.sendNotification(a.DidOpenTextDocumentNotification.type,t),didChangeTextDocument:t=>e.sendNotification(a.DidChangeTextDocumentNotification.type,t),didCloseTextDocument:t=>e.sendNotification(a.DidCloseTextDocumentNotification.type,t),didSaveTextDocument:t=>e.sendNotification(a.DidSaveTextDocumentNotification.type,t),onDiagnostics:t=>e.onNotification(a.PublishDiagnosticsNotification.type,t),dispose:()=>e.dispose(),end:()=>e.end()}}(e,t,i))}})}ci.install(v);const t=(i="/sampleServer",`${"https:"===location.protocol?"wss":"ws"}://${location.host}${location.pathname}${i}`);var i;const n=new J(t,[],Object.create({maxReconnectionDelay:1e4,minReconnectionDelay:1e3,reconnectionDelayGrowFactor:1.3,connectionTimeout:1e4,maxRetries:1/0,debug:!1}));_.listen({webSocket:n,onConnection:t=>{const i=e(t).start();t.onClose((()=>i.dispose()))}})}async function hi(e){const t=await async function(){return li||(await m((()=>import("./createWorker.5114727e.js")),["assets/createWorker.5114727e.js","assets/index.ee2a88f2.js","assets/index.acc7ba65.css","assets/parser.d5d33482.js","assets/lsp.289540be.js","assets/vsc.14d9df5d.js"]),console.log("createWorker"),li=f.createWebWorker({moduleId:"advscript",label:"advscript",keepIdleModels:!0,createData:{}})),await li.getProxy()}();return new ui(e,t,"advscript").initialize()}export{gi as startClient,hi as startClientService};
